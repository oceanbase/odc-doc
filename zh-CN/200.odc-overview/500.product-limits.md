# 使用限制

本篇介绍 OceanBase 开发者中心（OceanBase Developer Center，ODC）安装部署的环境要求以及各功能模块所涉及的使用限制。

## Web 版
| 环境 | 要求 |
| ------ | ------ |
| 操作系统 | <ul><li> CentOS 7.2 及之后的版本。</li><li> AliOS 7.2 及之后的版本。</li><li> 华为 EulerOS 2.0 SP8。 |
| Docker | 推荐使用 20.10 及之后的版本。 |
| 浏览器 | <ul><li> Chrome 76 及之后的版本。</li><li> Firefox 60 及之后的版本。</li><li> Edge 79 及之后的版本。</li></ul> |
| CPU | X86 或 ARM 架构，64 位处理器 2 核及以上配置。 |
| 内存 | 4GB 及以上。 |

## 桌面版
| 环境 | 要求 |
| ------ | ------ |
| 操作系统 | <ul><li> Windows：Win 7/Win 10。</li><li> Mac：10.13.6（17G65）。</li><li> Linux：Ubuntu 18.x/Ubuntu 20.x/统信桌面版 UOS 1060。</li></ul>|
| Java | JDK >= 1.8.0_200 且 JDK < 9 <main id="notice" type='explain'><h4>说明</h4><p>ODC V3.2.0 及之后的版本，桌面版安装包中已附加 JRE 安装包（包含 Mac 和 Win 64 位平台），不依赖部署环境的 JRE。</p></main>|
| CPU | X86 64 位处理器 2 核及以上的配置。 |
| 内存 | 4GB 及以上。 |

# 产品能力限制
## 数据源限制概览
数据源管理

| 数据源 | 添加数据源 | SQL 开发规范 | 审批流程 | 数据清理 | 数据归档 | 数据脱敏 | 操作记录 |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| OceanBase Oracle | &#10004; | &#10004; | &#10004; | &#10006; | &#10006; | &#10004; | &#10004; |
| OB Cloud Oracle | &#10004; | &#10004; | &#10004; | &#10006; | &#10006; | &#10004; | &#10004; |
| OceanBase MySQL | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
| OB Cloud MySQL | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
| OB Sharding MySQL | &#10004; | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10004; |
| MySQL | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |

SQL 开发限制

| 类别 | 功能 | OceanBase Oracle | OB Cloud Oracle | OceanBase MySQL | OB Cloud MySQL |OB Sharding MySQL | MySQL |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| SQL 窗口 | SQL 执行 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | SQL 检查 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 自动补全 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 执行计划 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 格式化 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 结果集查看 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 结果集搜索 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 结果集编辑 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 结果集导出 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10006; |
|  | 脚本管理 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 代码片段 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 设置 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
| 白屏对象管理 | 表 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 视图 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 函数 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 存储过程 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 程序包 | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; |
|  | 触发器 | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; |
|  | 类型 | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; |
|  | 序列 | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; |
|  | 同义词 | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; |
|  | 匿名块 | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; |
| PL 能力 | 编译 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10006; |
|  | 运行 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 调试 | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; | &#10006; |
| 工单 | 导入 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 导出 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 模拟数据 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10004; |
|  | 数据库变更 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 影子表同步 | &#10006; | &#10006; | &#10004; | &#10004; | &#10006; | &#10006; |
|  | SQL 计划 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 分区计划 | &#10006; | &#10006; | &#10004; | &#10004; | &#10006; | &#10006; |
|  | 无锁结构变更 | &#10004; | &#10004; | &#10006; | &#10006; | &#10006; | &#10006; |
| 数据库运维 | 会话管理 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 会话变量管理 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |
|  | 回收站管理 | &#10004; | &#10004; | &#10004; | &#10004; | &#10006; | &#10006; |
|  | 命令行窗口 | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; | &#10004; |


## 数据源版本支持限制
| ODC 支持的数据源类型 | 支持版本 |
| ------ | ------ |
| OceanBase Oracle <br> Cloud Oracle <br> OceanBase MySQL <br> OB Cloud MySQL | <ul><li> OceanBase V1.4.x </li><li> OceanBase V2.0.x </li><li> OceanBase V2.1.x </li><li> OceanBase V2.2.x </li><li> OceanBase V3.1.x </li><li> OceanBase V3.2.x </li><li> OceanBase V4.0.0 </li><li> OceanBase V4.1.0 </li><li> OceanBase V4.2.0 </li><li> OceanBase V4.2.1 </li><li> OceanBase 社区版</li></ul>|
| OB Sharding MySQL | <ul><li> Sofa ODP V1.15.9 及之后的版本。</li><li> ODP V3.2.8 及之后的版本。</li></ul> |
| MySQL | MySQL 5.7 |

## 功能使用限制

### 权限限制

- OceanBase V4.0.0 及之后的版本，若要进行调试，需保证用户已具备调试权限。调试权限： `GRANT DEBUG CONNECT SESSION TO <user>`; `GRANT DEBUG ANY PROCEDURE TO <user>`。

- ODC V4.1.3-bp4 之前版本，OceanBase MySQL 数据源中配置的用户需要具有 mysql.proc 权限，否则进入数据源内部查看函数、存储过程报错。

- ODC V4.1.0 之前版本，针对 OceanBase 数据源，若要导出除表、视图外的其它对象或需要较好的导数速度，需要配置 sys 租户账号（拥有 sys 租户查询权限的账号）。

- ODC V4.1.0 及之后版本，针对 OceanBase 数据源，若需要较好的导数速度，需要配置 sys 租户账号。

### 会话限制

- ODC V4.2.0 之前版本提供了共享 session 设计。共享 session 下，连接内部所有窗口共用一个 session。当您在任意窗口触发提交或回滚操作（含隐式提交场景，如创建、修改、删除数据库对象结构或执行 DDL 语句），该提交或回滚操作影响所有窗口。关于共享 session 和独立 session 的设置，请参见：[如何修改 SQL 窗口的会话模式](../1300.troubleshooting/400.faq/300.connection-information-faq.md)。

- ODC V2.3.2 之后版本，OceanBase Oracle 模式下事务提交模式默认为手动。若需要调整事务提交模式，请参见：[如何调整事务提交模式](../1300.troubleshooting/400.faq/300.connection-information-faq.md)。

- ODC 提供了手动、自动两种事务提交模式。手动提交模式下，若数据源为 OceanBase 数据源，为了避免因为事务内两个 SQL 之间的执行间隔超过 `ob_trx_idle_timeout` 设置的时间而导致连接被终止，需要合理设置 `ob_trx_idle_timeout` 大小。一般情况下 `ob_trx_idle_timeout` 的大小需大于 SQL 查询超时时间，同时需要注意该参数设置过大会导致该会话占用内存无法及时释放，需谨慎设置。

### PL 限制

ODC PL 支持现状

| 功能 | 支持的对象 | 支持的数据源 | 支持版本 |
| ------ | ------ | ------ | ------ |
| 编译 | 函数/存储过程/程序包 | OceanBase Oracle<br>OB Cloud Oracle | V2.2.7x、V3.0.0 及之后版本。 |
| 调试 | 函数/存储过程/匿名块 | OceanBase Oracle | V3.2.3 及之后版本。 |
| 运行 | 函数/存储过程 | OceanBase Oracle<br>OB Cloud Oracle<br>OceanBase MySQL<br>OB Cloud MySQL | V2.0.x 及之后版本。 |
|  | 函数/存储过程 | MySQL  | V5.7 |
| 运行 | 程序包/匿名块 | OceanBase Oracle<br>OB Cloud Oracle | V2.0.x 及之后版本。 |

同时需要注意：

- 若数据源为 OceanBase，有且仅能通过 OBProxy 连接，该实例将不支持调试。

- 匿名块窗口仅在 OceanBase Oracle/OB Cloud Oracle 数据源提供。

- ODC V3.2.3 之前版本不支持在 arm 架构下进行调试。

### SQL 开发限制

- 编辑结果集时，不支持对包含 SET、ENUM 字段类型的查询结果集进行编辑。

### 导入与导出限制

- Web 版 ODC 对导出的数据大小有限制，最大支持导出 2GB 的数据（压缩前），超出部分无法导出。如需导出大量数据，请使用导数工具 OBDUMPER。

- Web 版 ODC 对导入上传的文件大小有限制，最大支持导入 2GB（压缩后）的文件，超出部分无法上传。如需导入大量数据，请使用导数工具 OBLOADER。

- 最大支持 5 个导入导出任务并行运行，后续任务在队列中等待运行。

- 导入导出任务涉及的文件默认保留 14 天。

- 在 ODC V4.1.0 之后版本，针对 OceanBase 数据源，配置  sys 租户账号可以提升导入导出速度。同时导出除表、视图之外的其它对象时不再要求必须配置 sys 租户账号。

### 变更回滚限制

- 只支持对 UPDATE 和 DELETE 变更语句自动生成回滚语句。

- 支持的变更影响行数上限为 100W，超过则不支持自动生成回滚语句。

- 若表中包含大字段，不支持自动生成回滚语句。

- OceanBase MySQL、MySQL 数据源下，若表中无主键或者唯一键，不支持自动生成回滚语句。

- UPDATE 语句的修改字段（Set）和条件字段（Where）相同，不支持自动生成回滚语句。

- 最大支持生成的自动回滚语句脚本大小为 256MB。

### 分区计划限制

- 仅支持 OceanBase MySQL 数据源。

- 仅支持Timestamp 字段类型的 Range 分区表及 Date 字段类型的 Range Columns 分区表。

### 模拟数据限制

- 单次模拟数据上限为 1 亿行。

- 拥有检查约束的表，不支持对其进行模拟数据。

- 使用 ZHSGB2312 编码的表，不支持对其进行模拟数据。

### 命令行窗口

- MacOS 桌面版不提供命令行窗口。

- 最多可同时打开 3 个命令行窗口。

- 命令行窗口操作暂未纳入操作记录。

### 数据归档限制

- 前置条件：

   - OceanBase 数据源必须通过 OBproxy 连接（暂不支持对直连的 OceanBase 进行归档操作）。

   - OceanBase 数据源目前仅支持集群实例，新建数据源时必须配置集群名称。

   - 非同类型数据源，数据归档不支持自动创建目标表。

   - 需保证源端表字段在目标端兼容，数据归档不处理字段兼容性问题。

   - MySQL 数据源暂不支持 CPU 内存防爆能力。

- 归档链路支持：

   - OceanBase MySQL 到 OceanBase MySQL 。

   - MySQL 到 MySQL。

   - MySQL  到 OceanBase MySQL 。

   - OceanBase MySQL 到 MySQL。

- 以下情况不支持归档：

   - 若表中不包含主键 PRIMARY KEY，不支持进行归档。

   - 若表中包含 bit、enum、set、xml 、geometry字段类型，不支持进行归档。

   - 若归档条件中包含 limit 语句，不支持进行归档。

   - 若表中包含外键，不支持进行归档。

### 数据清理限制

- 前置条件：

   - OceanBase 数据源必须通过 OBproxy 连接（暂不支持对直连的 OceanBase 进行归档操作）。

   - OceanBase 数据源目前仅支持集群实例，新建数据源时必须配置集群名称。

   - MySQL 数据源暂不支持 CPU 内存防爆能力。

- 清理数据源支持：

   - OceanBase MySQL 数据源。

   - MySQL 数据源。

- 以下情况不支持清理：

   - 若表中不包含主键 PRIMARY KEY，不支持进行清理。

   - 若表中包含 bit、enum、set、xml、geometry 字段类型，不支持进行清理。

   - 若归档条件中包含 limit 语句，不支持进行清理。

   - 若表中包含外键，不支持进行清理。

### 数据脱敏限制

- 数据脱敏暂未覆盖命令行窗口场景。

- 数据脱敏暂未覆盖 PL 执行场景。

- 配置识别规则脚本时，Groovy 只允许用户使用 Java 中的 Objects 类 和 String 类。

- 配置识别规则脚本时，不支持 Groovy 闭包、自带的闭包函数。

- MySQL 数据源导出若涉及敏感数据使用全部遮掩算法脱敏。

### 无锁结构变更

<main id="notice" type='notice'>
   <h4>注意</h4>
   <p>无锁结构变更任务仅支持 OceanBase 社区版和阿里云数据库 OceanBase 版。</p>
</main>

- 表中须存在主键或非空唯一键且表中不存在外键。

- OceanBase MySQL 模式下的表名称不超过 54 个字符，OceanBase Oracle 模式下的表名称不超过 118 个字符。

- ODC 连接 OceanBase 社区版数据库时，数据源配置信息中需包含集群名和 SYS 租户账号。

- OceanBase Oracle 模式版本小于 4.0.0 或 OceanBase MySQL 模式版本小于 4.3.0，ODC 通过锁定用户且关闭会话的方式避免表名切换过程中数据的写入。

- 无锁结构变更期间，发起其它关于该表的 DDL 变更将导致任务失败。

无锁结构变更支持的变更范围：

| 分类 | 操作 | 是否支持 |
| ------ | ------ | ------ |
| 列操作 | 列类型修改 | 支持 |
|  | 重排列（before/after/first） | 支持 |
|  | 转换字符集 | 支持 |
|  | 列重命名 | 不支持 |
|  | 增加列 | 不支持 |
|  | 删除列 | 不支持 |
|  | 增加主键列 | 不支持 |
| 主键 | 增加主键 | 支持（前提：表存在非空唯一键） |
|  | 修改主键 | 支持（前提：表存在非空唯一键） |
|  | 删除主键 | 支持（前提：表存在非空唯一键） |
| 分区 | 删除分区 | 支持 |
|  | truncate 分区 | 支持 |
|  | 重分区 | 支持 |
|  | 非分区表改为分区表 | 支持 |

### SSO 集成限制

- 只支持授权码模式。

- 退出登录时，只清除 ODC 应用的登录态，不会清理 SSO 系统的登录态。

- 映射名称必须为字符串 String 类型。