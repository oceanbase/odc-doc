# 使用限制

本篇介绍 OceanBase 开发者中心（OceanBase Developer Center，ODC）安装部署的环境要求以及各功能模块所涉及的使用限制。

## Web 版

| 环境 | 要求 |
| ------ | ------ |
| 操作系统 | <ul><li> CentOS 7.2 及之后的版本。</li><li> AliOS 7.2 及之后的版本。</li><li> 华为 EulerOS 2.0 SP8。 |
| Docker | 推荐使用 20.10 及之后的版本。 |
| 浏览器 | <ul><li> Chrome 76 及之后的版本。</li><li> Firefox 60 及之后的版本。</li><li> Edge 79 及之后的版本。</li></ul> |
| CPU | X86 或 ARM 架构，64 位处理器 2 核及以上配置。 |
| 内存 | 4GB 及以上。 |

## 桌面版

| 环境 | 要求 |
| ------ | ------ |
| 操作系统 | <ul><li> Windows：Win 7/Win 10/Win Server 2016 /Win Server 2019。</li><li> Mac：10.13.6（17G65）。</li><li> Linux：Ubuntu 18.x/Ubuntu 20.x/统信 UOS 1060 arm-desktop。</li></ul>|
| Java | JDK >= 1.8.0_200 且 JDK < 9 <main id="notice" type='explain'><h4>说明</h4><p>ODC V3.2.0 及之后的版本，桌面版安装包中已附加 JRE 安装包（包含 Mac 和 Win 64 位平台），不依赖部署环境的 JRE。</p></main>|
| CPU | X86 64 位处理器 2 核及以上的配置。 |
| 内存 | 4GB 及以上。 |


## 数据源类型支持概览

| 类别 | 功能 | OceanBase Oracle | OB Cloud Oracle | OceanBase MySQL | OB Cloud MySQL | OB Sharding MySQL | MySQL | Oracle | Doris |PostgreSQL|
| ------ | ------ | ------ | ------ | ------ | ------ | ------------ | --------- | --------- | --------- |--------- |
| 管控协同 | 变更审批 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | SQL 窗口规范 | 支持| 支持| 支持| 支持| 支持| 支持| 不支持 | 支持|不支持|
|  | SQL 检查规范 | 支持| 支持| 支持| 支持| 支持| 支持| 不支持 | 不支持 |不支持|
| 安全合规 | 数据脱敏 | 支持| 支持| 支持| 支持| 不支持 | 支持| 支持| 支持|不支持|
|  | 操作记录 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
| 数据生命周期 | 数据清理 | 支持| 支持| 支持| 支持| 不支持 | 支持| 不支持 | 不支持 |支持|
|  | 数据归档 | 支持| 支持| 支持| 支持| 不支持 | 支持| 不支持 | 不支持 |支持|
|  | 分区计划 | 支持| 支持| 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 |不支持|
| SQL 窗口 | SQL 执行 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | SQL 检查 | 支持| 支持| 支持| 支持| 支持| 支持| 不支持 | 不支持 |不支持|
|  | 自动补全 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 执行计划 | 支持| 支持| 支持| 支持| 不支持 | 支持| 不支持 | 不支持 |不支持|
|  | 格式化 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 全链路追踪 | 支持| 支持| 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 |不支持|
|  | 结果集查看 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 结果集搜索 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 结果集编辑 | 支持| 支持| 支持| 支持| 支持| 支持| 不支持 | 支持|不支持|
|  | 结果集导出 | 支持| 支持| 支持| 支持| 不支持 | 支持| 支持| 支持|不支持|
|  | 脚本管理 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 代码片段 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 设置 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
| 白屏对象管理 | 表 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 视图 | 支持| 支持| 支持| 支持| 不支持 | 支持| 支持| 不支持 |不支持|
|  | 函数 | 支持| 支持| 支持| 支持| 不支持 | 支持| 支持| 不支持 |不支持|
|  | 存储过程 | 支持| 支持| 支持| 支持| 不支持 | 支持| 支持| 不支持 |不支持|
|  | 程序包 | 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 | 支持| 不支持 |不支持|
|  | 触发器 | 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 | 支持| 不支持 |不支持|
|  | 类型 | 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 | 支持| 不支持 |不支持|
|  | 序列 | 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 | 支持| 不支持 |不支持|
|  | 同义词 | 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 | 支持| 不支持 |不支持|
|  | 匿名块 | 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 | 支持| 不支持 |不支持|
| PL 能力 | 编译 | 支持| 支持| 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 |不支持|
|  | 运行 | 支持| 支持| 支持| 支持| 不支持 | 支持| 不支持 | 不支持 |不支持|
|  | 调试 | 支持| 不支持 | 不支持 | 不支持 | 不支持 | 不支持 | 不支持 | 不支持 |不支持|
| 工单 | 导入 | 支持| 支持| 支持| 支持| 不支持 | 支持| 支持| 支持|不支持|
|  | 导出 | 支持| 支持| 支持| 支持| 不支持 | 支持| 支持| 支持|不支持|
|  | 模拟数据 | 支持| 支持| 支持| 支持| 不支持 | 支持| 不支持 | 不支持 |不支持|
|  | 数据库变更 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 影子表同步 | 不支持 | 不支持 | 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 |不支持|
|  | SQL 计划 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 无锁结构变更 | 支持| 支持| 支持 | 支持 | 不支持 | 不支持 | 不支持 | 不支持 |不支持|
| 数据库运维 | 会话管理 | 支持| 支持| 支持| 支持| 支持| 支持| 支持| 支持|不支持|
|  | 会话变量管理 | 支持| 支持| 支持| 支持| 支持| 支持| 不支持 | 支持|不支持|
|  | 回收站管理 | 支持| 支持| 支持| 支持| 不支持 | 不支持 | 不支持 | 不支持 |不支持|
|  | 命令行窗口 | 支持| 支持| 支持| 支持| 支持| 支持| 不支持 | 支持|不支持|

<main id="notice" type='explain'>
   <h4>说明</h4>
   <ul>
   <li>关于 Oracle 数据源：<ul><li>表、视图、函数、存储过程、程序包、触发器、类型、序列、同义词对象仅支持结构查看。</li><li>表数据支持查看、编辑。</li><li>匿名块仅支持运行。</li></ul></li>
   <li>关于 PostgreSQL 数据源：<ul><li>仅支持数据归档、数据清理。</li>
   </ul></li>
   </ul>
</main>

## 数据源版本支持限制

| ODC 支持的数据源类型 | 支持版本 |
| ------ | ------ |
| OceanBase Oracle <br> OB Cloud Oracle <br> OceanBase MySQL <br> OB Cloud MySQL | <ul><li> OceanBase V1.4.x </li><li> OceanBase V2.0.x </li><li> OceanBase V2.1.x </li><li> OceanBase V2.2.x </li><li> OceanBase V3.1.x </li><li> OceanBase V3.2.x </li><li> OceanBase V4.0.0 </li><li> OceanBase V4.1.0 </li><li> OceanBase V4.2.0 </li><li> OceanBase V4.2.1 </li><li>OceanBase V4.2.2</li><li>OceanBase V4.2.3</li><li>OceanBase V4.3.0</li><li>OceanBase V4.2.4</li><li>OceanBase V4.3.1</li><li>OceanBase V4.3.2</li><li> OceanBase 社区版</li></ul>|
| OB Sharding MySQL | <ul><li> Sofa ODP V1.15.9 及之后的版本。</li><li> ODP V3.2.8 及之后的版本。</li></ul> |
| MySQL | MySQL 5.7|
| Oracle | Oracle 11g |
|PostgreSQL|PostgreSQL 15.3|
| Doris | Doris 2.0.0 及之后的版本|

## 功能使用限制

### 权限限制

- OceanBase V4.0.0 及之后的版本，若要进行调试，需保证用户已具备调试权限。调试权限： `GRANT DEBUG CONNECT SESSION TO <user>`; `GRANT DEBUG ANY PROCEDURE TO <user>`。

- ODC V4.1.3-bp4 之前版本，OceanBase MySQL 数据源中配置的用户需要具有 mysql.proc 权限，否则进入数据源内部查看函数、存储过程报错。

- ODC V4.1.0 之前版本，针对 OceanBase 数据源，若要导出除表、视图外的其它对象或需要较好的导数速度，需要配置 sys 租户账号（拥有 sys 租户查询权限的账号）。

- ODC V4.1.0 及之后版本，针对 OceanBase 数据源，若需要较好的导数速度，需要配置 sys 租户账号。

### 会话限制

- ODC V4.2.0 之前版本提供了共享 session 设计。共享 session 下，连接内部所有窗口共用一个 session。当您在任意窗口触发提交或回滚操作（含隐式提交场景，如创建、修改、删除数据库对象结构或执行 DDL 语句），该提交或回滚操作影响所有窗口。关于共享 session 和独立 session 的设置，请参见：[如何修改 SQL 窗口的会话模式](../1300.troubleshooting/400.faq/300.connection-information-faq.md)。

- ODC V2.3.2 之后版本，OceanBase Oracle 模式下事务提交模式默认为手动。若需要调整事务提交模式，请参见：[如何调整事务提交模式](../1300.troubleshooting/400.faq/300.connection-information-faq.md)。

- ODC 提供了手动、自动两种事务提交模式。手动提交模式下，若数据源为 OceanBase 数据源，为了避免因为事务内两个 SQL 之间的执行间隔超过 `ob_trx_idle_timeout` 设置的时间而导致连接被终止，需要合理设置 `ob_trx_idle_timeout` 大小。一般情况下 `ob_trx_idle_timeout` 的大小需大于 SQL 查询超时时间，同时需要注意该参数设置过大会导致该会话占用内存无法及时释放，需谨慎设置。

### PL 限制

ODC PL 支持现状

| 功能 | 支持的对象 | 支持的数据源 | 支持版本 |
| ------ | ------ | ------ | ------ |
| 编译 | 函数/存储过程/程序包 | OceanBase Oracle<br>OB Cloud Oracle | V2.2.7x、V3.0.0 及之后版本。 |
| 调试 | 函数/存储过程/匿名块 | OceanBase Oracle | V3.2.3 及之后版本。 |
| 运行 | 函数/存储过程 | OceanBase Oracle<br>OB Cloud Oracle<br>OceanBase MySQL<br>OB Cloud MySQL | V2.0.x 及之后版本。 |
| 运行 | 函数/存储过程 | MySQL  | V5.7 |
| 运行 | 程序包/匿名块 | OceanBase Oracle<br>OB Cloud Oracle | V2.0.x 及之后版本。 |

<main id="notice" type='notice'>
  <h4>注意</h4>
  <ul>
  <li>若数据源为 OceanBase，有且仅能通过 OBProxy 连接，该实例将不支持调试。</li>
  <li>匿名块窗口仅在 OceanBase Oracle/OB Cloud Oracle 数据源提供。</li>
  <li>ODC V3.2.3 之前版本不支持在 ARM 架构下进行调试。</li>
  </ul>
</main>

### SQL 开发限制

- 编辑结果集时，不支持对包含 SET、ENUM 字段类型的查询结果集进行编辑。

- 全链路追踪仅支持 OceanBase V4.0.0 及之后的版本。

### 导入与导出限制

- ODC 对导出的数据大小有限制，Web 版 ODC 最大支持导出 2GB 的数据（压缩前）超出部分无法导出。如需导出大量数据，请使用导数工具 [OBDUMPER](https://www.oceanbase.com/docs/common-oceanbase-dumper-loader-1000000000246581)。

- Web 版 ODC 对导入上传的文件大小有限制，最大支持导入 2GB（压缩后）的文件，超出部分无法上传。如需导入大量数据，请使用导数工具 OBLOADER。

- 最大支持 5 个导入导出任务并行运行，后续任务在队列中等待运行。

- 导入导出任务涉及的文件默认保留 14 天。

- 在 ODC V4.1.0 之后版本，针对 OceanBase 数据源，配置  sys 租户账号可以提升导入导出速度。同时导出除表、视图之外的其它对象时不再要求必须配置 sys 租户账号。

### 变更回滚限制

- 只支持对 UPDATE 和 DELETE 变更语句自动生成回滚语句。

- 支持的变更影响行数上限为 100W，超过则不支持自动生成回滚语句。

- 若表中包含大字段，不支持自动生成回滚语句。

- OceanBase MySQL、MySQL 数据源下，若表中无主键或者唯一键，不支持自动生成回滚语句。

- UPDATE 语句的修改字段（Set）和条件字段（Where）相同，不支持自动生成回滚语句。

- 最大支持生成的自动回滚语句脚本大小为 256MB。

### 分区计划限制

- 仅支持 OceanBase MySQL 和 OceanBase Oracle 数据源。

- 仅支持 Range 分区表。

- Range 分区表中的最后一个分区上限值为 MAXVALUE 时，数据库不允许新增分区，因此不支持通过 ODC 分区计划任务创建分区策略。

### 模拟数据限制

- 单次模拟数据上限为 1 亿行。

- 拥有检查约束的表，不支持对其进行模拟数据。

- Range，List 分区表不支持对其进行模拟数据。

### 结构比对限制

- 链路支持：

  - OceanBase MySQL 到 OceanBase MySQL。

  - OceanBase Oracle 到 OceanBase Oracle。

  - MySQL 到 MySQL。

- 仅支持比对表对象，比对属性范围仅包含列、主键、约束、索引、分区、表属性。

  - 关于列属性，仅支持比对类型、字符集、排序规则、注释、缺省值。

  - 关于分区，仅支持比对一级分区不支持比对二级分区。

  - 关于表属性，仅支持比对字符集、排序规则、注释。

- OceanBase MySQL 不支持比对检查约束。

- OceanBase MySQL V1.4.79 之前版本，如果没有 sys 租户查询权限，不支持对比分区属性。 

### 命令行窗口限制

- MacOS 桌面版不提供命令行窗口。

- 最多可同时打开 3 个命令行窗口。

- 命令行窗口操作暂未纳入操作记录。

### 数据归档限制

- 前置条件：

   - 需保证源端表字段在目标端兼容，数据归档不处理字段兼容性问题。

   - MySQL 数据源暂不支持 CPU 内存防爆能力。

   - 同构归档链路二级分区不支持表结构同步，异构数据库不支持结构同步以及自动建表。

- 归档链路支持：

   - OceanBase MySQL 到 OceanBase MySQL 。

   - OceanBase Oracle 到 OceanBase Oracle。

   - MySQL 到 MySQL。

   - MySQL 到 OceanBase MySQL。

   - OceanBase MySQL 到 MySQL。

   - Oracle 到 Oracle。

   - Oracle 到 OceanBase Oracle。

   - OceanBase Oracle 到 Oracle。

   - PostgreSQL 到 OceanBase MySQL。

- 以下情况不支持归档：

  - OceanBase MySQL 及 MySQL 数据源若表中不包含主键 PRIMARY KEY 或唯一非空索引，不支持归档。

  - OceanBase Oracle、Oracle 和 PostgreSQL 数据源若表中不包含主键 PRIMARY KEY，不支持归档。

  - OceanBase Oracle 数据源若表中包含 JSON、XMLTYPE 字段类型，不支持归档。

  - PostgreSQL 数据源若表定义中包含数组类型、复合类型、枚举类型、几何类型、XML 类型、HSTORE 类型、全文检索，不支持归档。

  - 若归档条件中包含 limit 语句，不支持归档。

  - 若表中包含外键，不支持归档。

- 以下归档链路不支持自动建表及表结构同步

  - Oracle 到 OceanBase Oracle
  - OceanBase Oracle  到 Oracle
  - MySQL 到 OceanBase MySQL
  - OceanBase MySQL 到 MySQL
  - PostgreSQL 到 OceanBase MySQL

### 数据清理限制

- 前置条件：

   - MySQL 数据源暂不支持 CPU 内存防爆能力。

- 清理数据源支持：

   - OceanBase MySQL 数据源。

   - OceanBase Oracle 数据源。

   - MySQL 数据源。

   - Oracle 数据源。

   - PostgreSQL 数据源。

- 以下情况不支持清理：

  - OceanBase MySQL 及 MySQL 数据源若表中不包含主键 PRIMARY KEY 或唯一非空索引，不支持清理。
  
  - OceanBase Oracle、Oracle 和 PostgreSQL 数据源若表中不包含主键 PRIMARY KEY，不支持清理。
  
  - OceanBase Oracle 数据源若表中包含 JSON、XMLTYPE 字段类型，不支持清理。

   - 若归档条件中包含 limit 语句，不支持清理。

   - 若表中包含外键，不支持清理。

### 数据脱敏限制

- 数据脱敏暂未覆盖命令行窗口场景。

- 数据脱敏暂未覆盖 PL 执行场景。

- 配置识别规则脚本时，Groovy 只允许用户使用 Java 中的 Objects 类 和 String 类。

- 配置识别规则脚本时，不支持 Groovy 闭包、自带的闭包函数。

- MySQL 数据源导出若涉及敏感数据使用全部遮掩算法脱敏。

- Oracle 数据源导出若涉及敏感数据使用全部遮掩算法脱敏。

- Doris 数据源导出若涉及敏感数据使用全部遮掩算法脱敏。

### 无锁结构变更限制

<main id="notice" type='notice'>
   <h4>注意</h4>
   <p>无锁结构变更任务仅支持 OceanBase 社区版、阿里云数据库 OceanBase 版和企业版 OceanBase 迁移服务（OMS）。</p>
</main>

- 表中须存在主键或非空唯一键且表中不存在外键。

- OceanBase MySQL 模式下的表名称不超过 54 个字符，OceanBase Oracle 模式下的表名称不超过 118 个字符。

- ODC 连接 OceanBase 社区版数据库时，数据源配置信息中需包含集群名和 SYS 租户账号。

- OceanBase Oracle 模式版本小于 4.0.0 或 OceanBase MySQL 模式版本小于 4.3.0，ODC 通过锁定用户且关闭会话的方式避免表名切换过程中数据的写入。

- 无锁结构变更期间，发起其它关于该表的 DDL 变更将导致任务失败。

- 使用阿里云数据库 OceanBase 版 ODC 创建无锁结构变更任务前，须确认已存在 OMS 空闲实例。

无锁结构变更支持的变更范围：

| 分类 | 操作 | 是否支持 ||
| ------ | ------ | ------ |------ |
| 列操作 | 列类型修改 | 是|  |
|       | 重排列（before/after/first） | 是|  |
|       | 转换字符集 | 是|  |
|  | 列重命名 | 否 ||
|  | 增加列 | 是（为表添加中间列）||
|  | 删除列 | 否 ||
|  | 增加主键列 | 否 ||
|主键 | 增加主键 | 是| 表存在非空唯一键 |
|  | 修改主键 | 是| 表存在非空唯一键 |
|  | 删除主键 | 是| 表存在非空唯一键 |
| 分区 | 删除分区 | 是|  |
|  | truncate 分区 | 是|  |
|  | 重分区 | 是|  |
|  | 非分区表改为分区表 | 是 |  |

### 多库变更

- 变更的数据库必须在同一项目中。

- 支持变更的数据库数量范围：2~100。

- 参与多库变更的数据库不能重复。

- 执行数据库变更任务期间，不允许终止该任务流程。即目前自动模式下不支持终止任务流程。手动执行时，在等待下一批次执行前可以终止任务流程，数据库变更时不可终止任务流程。

### 登录集成限制

- OAUTH/OIDC 仅支持授权码模式。

- OAUTH/OIDC 退出登录时，仅支持清除 ODC 应用的登录态，不支持清理 SSO 系统的登录态。

### 逻辑库使用限制

- 仅支持 OceanBase MySQL、MySQL 数据源。

- 仅支持 DDL 变更。

- 不支持 ODC 安全规范中的 SQL 检查规范及 SQL 窗口规范。