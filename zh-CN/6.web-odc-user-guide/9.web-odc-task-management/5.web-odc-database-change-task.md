数据库变更任务 
============================

在 OceanBase 开发者中心（OceanBase Developer Center，ODC）创建数据库变更任务后，您可以在 **任务中心** 面板的 **数据库变更** 页签新建和查看任务。

任务列表 
-------------------------

进入目标数据库连接后，单击顶部导航栏中的 **任务中心** 标签弹出任务中心面板，在面板中单击数据库变更 页签显示任务列表。

![Image 456](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3539527461/p263522.png)

进入数据库变更任务页签后，列表中会显示以下信息并且支持筛选和排序：


|  信息项  |                                                                                                                                                                                                                                                   说明                                                                                                                                                                                                                                                   |
|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 任务编号  | 数据库变更任务编号。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 任务类型  | 显示新建任务时指定的任务类型（导入、导出、模拟数据或数据库变更）。                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 所属连接  | 展示目标任务所在的数据库连接名称。 单击筛选图标![筛选](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0583667361/p352180.jpg)，可筛选所属连接。                                                                                                                                                                                                                                                                                                                                                            |
| 所属数据库 | 选择需变更的数据库。 单击搜索图标![搜索](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5526247461/p416691.jpg)，可搜索和筛选所属数据库。                                                                                                                                                                                                                                                                                                                                                               |
| 创建人   | 创建数据库变更任务的用户。 单击搜索图标![搜索](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5526247461/p416691.jpg)，可搜索和筛选创建人。                                                                                                                                                                                                                                                                                                                                                              |
| 创建时间  | 显示该任务生成的具体日期和时间。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 任务状态  | 显示任务的当前状态（不同状态下提供的管理操作不同）。                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 操作    | 提供 **查看** 、 **通过/拒绝** 、 **终止** 、 **回滚** 和 **下载**  等任务管理操作。 <li> 查看：单击该按钮进入任务详情页面以查看目标任务的 **任务信息**、执行结果和 **任务日志**。</li>   <li> 通过/拒绝：单击该按钮审批执行中的任务。</li>   <li> 终止：任务运行中时，单击该按钮终止任务。</li>   <li> 回滚：任务成功时，单击该按钮回滚任务。</li>   <li> 下载：任务成功时，单击该按钮下载导出文件至本地。</li>    |



新建数据库变更 
----------------------------

![任务-数据库变更-新建](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3761437461/p416182.png)

1. 登录 ODC 进入目标连接后，单击顶部导航栏中的 **任务中心** ，在弹出的任务面板中，单击 **全部任务** \> **数据库变更** \> **新建数据库变更** ，创建数据库变更任务。

   

2. 在 **新建数据库变更** 面板中，输入以下信息。

   

   |  信息项   |                                                                                                                                                                                                                                                                                                                                                                                                                                              说明                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |--------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   | 所属连接   | 展示目标任务所在的数据库连接名称。                                                                                                                                                                                                                                                                                                                                                                                         |
   | 所属库    | 选择需变更的数据库。                                                                                                                                                                                                                                                                                                                                                                                                |
   | SQL 内容 | 选择 **SQL 录入** 或 **上传附件** ：<br> a. **SQL 录入** ：SQL 录入为默认方式，可在编辑区中直接录入 SQL 脚本。<br> **说明** <br> - 在 SQL 录入中，最大允许输入 500000 个字符，如超限可上传附件。<br>   - 单击 **IN 值转化** 按钮，可将批量复制的数据转化成 in（'A','B'）格式。<br> - 列值分隔符号为换行符。<br>   - 行值分隔符为空格或 TAB 值。<br> b. **上传附件** ：选择上传附件方式后，单击文件池进入文件资源管理器选择要导入的文件或者直接将导入文件拖入文件池中以完成文件上传。<br> **说明**<br>  - 最多支持上传 500 个文件，总文件大小不超过不超过 256 MB。<br>   - 默认附件按上传的先后排序，可拖拽改变顺序，任务执行时按文件顺序执行。<br>   - 当前只支持上传 .sql 后缀的 SQL 文件。       |
   | 回滚方案   | 指定 **回滚方案** 。 回滚方案支持 SQL 文本录入及上传附件方式，参见"SQL 内容"信息。                                                                                                      |
   | 分隔符    | 支持 delimiter 分隔符号。                                                                                                                                                                                                                                                                                                                              |
   | 查询结果限制 | 支持设置查询结果限制 (1-100w)。                                                                                                                                                                                                                                                                  |
   | 任务错误处理 | 数据库变更工具提供两种任务错误处理方式：<br> - **停止任务** ：停止任务为默认方式，运行脚本的过程中出现错误时会停止运行。<br>   - **忽略错误继续任务** ：选择忽略错误继续任务方式，在运行脚本出现错后将跳过错误语句继续执行。                                                                                                                                                                           |
   | 执行超时时间 | 在 **执行超时时间** 文本框中输入数字指定语句执行超时时间，单位为小时（默认超时时间为 48 小时，最大不超过 480 小时）。                                                                                                                                                           |
   | 任务描述   | 可在 **任务描述** 文本框中输入不超过 200 个字符的描述信息，该项为选填项。                                                                                                                                                        
   

3. 单击 **新建** ，完成新建数据库变更。

   




查看数据库变更任务 
------------------------------

### 任务信息 

![任务-异步执行-任务详情](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3539527461/p325158.png)

1. 单击操作列中的 **查看** 按钮弹出目标任务的任务详情面板，在面板中单击 **任务信息** 标签查看 **所属连接** 、 **所属数据库** 、 **SQL 内容** 和 **回滚内容** 等信息。

   

2. 单击 **再次发起** ，可重新发起数据库变更任务。

   




### 任务流程 

![任务-数据库变更-查看-任务流程](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3761437461/p415537.png)

1. 单击操作列中的 **查看** 按钮弹出目标任务的任务详情面板，在面板中单击 **任务流程** 标签查看 **发起任务状态** 、 **审批状态** 、 **执行状态** 和 **完成** 结果 等信息。

   

2. 单击 **再次发起** ，可重新发起数据库变更任务。

   




### 执行结果 

![任务-数据库变更-查看-执行结果](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3761437461/p415540.png)

1. 单击操作列中的 **查看** 按钮弹出目标任务的任务详情面板，在面板中单击 **执行结果** 标签查看 执行成功和执行失败记录。

   

2. 单击 **再次发起** ，可重新发起数据库变更任务。

   




### 任务日志 

![任务-数据库变更-查看-任务日志](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/3761437461/p415541.png)

1. 单击操作列中的 **查看** 按钮弹出目标任务的任务详情面板，在面板的右上角单击 **任务日志** 标签查看任务的全部日志和告警日志。

   

   | 信息项  |                                                             说明                                                              |
   |------|-----------------------------------------------------------------------------------------------------------------------------|
   | 全部日志 | 全部日志显示任务的 **INFO** 、 **ERROR** 和 **WARN** 日志等全量信息。 单击 **查找** 、 **下载** 和 **复制** 按钮，可查找信息、下载或复制全部日志信息。        |
   | 告警日志 | 告警日志单独显示任务的 **ERROR** 和 **WARN** 日志。当任务失败时，可通过告警日志查看错误信息。 单击 **查找** 、 **下载** 和 **复制** 按钮，可查找信息、下载或复制告警日志信息。 |

   

2. 单击 **再次发起** ，可重新发起数据库变更任务。

   



