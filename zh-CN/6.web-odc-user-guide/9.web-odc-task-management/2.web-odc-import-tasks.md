导入任务 
=========================

在 OceanBase 开发者中心（OceanBase Developer Center，ODC）创建批量导入和单表导入任务后，可在 **任务中心** 面板的 **导入** 页签新建和查看任务。

任务列表 
-------------------------

> **说明**<br>
> 任务列表会显示最近 48 小时内的任务。
> 最大支持 3 个导入任务并行运行，后续任务在队列中等待运行。

进入目标数据库连接后，单击顶部导航栏中的 **任务中心** 标签弹出任务中心面板，在面板中单击 **导入** 页签显示任务列表。

![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/410/task/import/1.png)

进入导入任务页签后，列表中会显示以下信息并且支持筛选和排序：


|  信息项  |  说明 |
|-------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 任务编号  | 导入任务编号。|
| 任务类型  | 显示新建任务时指定的任务类型（导入、导出、模拟数据或数据库变更）。 |
| 所属连接  | 显示目标任务所在的数据库连接名称。 单击筛选图标![筛选](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/0583667361/p352180.jpg)，可筛选所属连接。  |
| 所属数据库 | 显示目标任务所在的数据库。 单击搜索图标![搜索](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5526247461/p416691.jpg)，可搜索和筛选所属数据库。 |
| 创建人   | 创建导入任务的用户。 单击搜索图标![搜索](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5526247461/p416691.jpg)，可搜索和筛选创建人。 |
| 创建时间  | 显示该任务生成的具体日期和时间。|
| 任务状态  | 显示任务的当前状态（不同状态下提供的管理操作不同）。 |
| 操作    | 提供 **查看** 、 **通过/拒绝** 、 **终止** 和 **下载** 等任务管理操作。<br> <li> 查看：单击该按钮进入任务详情页面以查看目标任务的 **任务信息** 和 **任务日志**。</li>   <li> 通过/拒绝：单击该按钮审批执行中的任务。</li>   <li>  终止：任务运行中时，单击该按钮终止任务。</li>   <li> 下载：任务成功时，单击该按钮下载导出文件至本地。</li>    |



新建导入任务 
---------------------------



1. 在弹出的任务中心面板中，单击 **导入** 右侧 **+** ，弹出新建导入任务面板。

   ![2](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/410/task/import/2.png)

2. 在弹出的任务面板中，选择导入文件格式。

   ![3](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/412/import%20task%201.png)

   如上图所示，ODC 目前支持批量导入 **CSV 文件** 、 **SQL 文件** 和 **ZIP 压缩文件** 。可在 **导入文件格式** 标签下的下拉框中选择需要的文件格式。具体格式信息，请参见 [导出导入格式](../../7.client-odc-user-guide/5.client-odc-use-tools/1.client-odc-data-export-and-import/2.client-odc-export-and-import-formats.md)。

   <main id="notice" type='explain'>
     <h4>说明</h4>
     <ul>
     <li><strong>导入文件格式</strong>为 CSV 文件时，支持跳过首行字段列头字段。</li>
     <li><strong>导入文件格式</strong>为 ZIP 压缩文件时，支持导入单表或者多表和跳过已存在的结构。</li>
     </ul>
   </main>


3. 上传导入文件。

   单击文件池进入文件资源管理器以选择需要导入的文件，或者直接将文件拖入文件池中以完成文件上传。上传的文件格式需要与所选择的导入文件格式相同，ZIP 压缩文件支持上传 .zip 结尾的文件、SQL 文件支持上传 .sql 文件以及 CSV 文件支持上传 .csv 文件。

4. 选择文件编码。

   ODC 目前支持 **ASCII** 、 **ISO-8859-1** 、 **GB2312** 、 **GBK** 、 **GB18030** 、 **Unicode（UTF-8）** 、 **Unicode（UTF-16）** 、 **Unicode（UTF-32）** 和 **BIG5** 等编码格式。可在 **文件编码** 下拉框中选择需要的编码格式。

5. 进入导入设置面板。

   单击 **下一步：导入设置** 对导入的文件和 sys 租户账号进行设置。

6. 选择导入内容。

   ![4](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/412/import%20task%202.png)

   

   当 **导入格式** 为 ZIP 压缩文件时需指定该项。ODC 目前支持 **仅导入数据** 、 **仅导入结构** 和 **导入数据和结构** 三种方式 **。** 其中导入结构指是否要导入对象的定义语句。可在 **导入内容** 标签下的选择框中选择需要导入的内容。

7. 选择所属库。

   选择导入对象所在的数据库。该项下同时显示目标任务所在数据库的连接名称。

8. 设置导入数据。

   当 **导入格式** 为 ZIP 压缩文件且 **导入内容** 不为仅导入结构时需设置导入数据。该项包含以下设置项：  

   * **导入前清空数据** ：勾选该项后，导入数据时将首先清空目标对象中原有的数据。

   * **批量提交数量** ：单击 **导入数据设置** 标签后的 **高级** 按钮，在弹出的列表中可指定该项。通过指定批量提交数量，可在导入文件中导入指定数量数据时添加一句 `COMMIT` 命令。

   * **不导入的数据类型** （可选）：可以通过该项指定导入数据时要跳过的数据类型。MySQL 和 Oracle 下可跳过的类型不同，支持多选。

9. 设置导入结构。

   当 **导入内容** 为仅导入数据时，该项不可被指定。在该项下选择当对象结构已存在时的操作。选择 **跳过** 操作则在导入时跳过导入文件中的结构定义语句直接导入数据，该项会保留对象中的原数据。选择 **替换** 操作时则执行导入文件中的结构定义语句以重新创建并替换原对象，该项会清空对象中的原数据。

10. 设置任务错误处理和执行方式。

    * ODC 提供 **停止任务** 和 **忽略错误继续任务** 两种错误处理方式。需要在 **任务错误处理** 标签下选择需要的处理方式。

    * 支持选择 **立即执行** / **定时执行** 。

11. 设置 sys 租户账号。

    a. 在该项下选择是否 **使用 sys 租户账号提升导出速度** ，勾选后输入 **账户** 和 **密码** 。

    b. 输入账户和密码信息后，单击密码框后的 **测试连接** 按钮测试账户信息是否正确。默认自动填入连接设置的账号，如连接失败，建议修改密码用于此次导出。

      <main id="notice" type='explain'>
      <h4>注意</h4>
      <ul>
      <li><strong>sys 租户账号和密码</strong> 为集群租户下用户的账号和密码 (账号请勿填入"@sys#集群")。如图所示： <a href="https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/9555336361/p348256.png">sys 租户账号配置</a></li>
      <li>如未配置 <strong>sys</strong> 租户账号，会导致导入导出缺少索引。</li>
      </ul>
      </main> 
      

12. 保留当前配置。

    指定所有信息后，勾选面板左下角的 **保留当前配置** 以保留当前部分数据文件和结构文件配置。

13. 生成导入任务。

    指定所有信息后，单击面板右下角的 **提交** 按钮以生成导入任务。

14. 查看导入任务。

    任务生成后会自动弹出 **任务中心** 面板，在任务中心可以查看任务信息。

    ![5](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/410/task/import/5.png)


查看导入任务 
---------------------------

### 任务信息 

单击操作列中的 **查看** 按钮弹出目标任务的任务详情面板，在面板的右上角单击 **任务信息** 标签查看任务基本信息、导入文件信息和导入对象信息。


|  信息项   |                                                                     说明                                                                      |
|--------|---------------------------------------------------------------------------------------------------------------------------------------------|
| 任务基本信息 | 显示 **任务编号** 、 **所属连接** 、 **所属数据库** 和 **任务类型** 等信息。   |
| 导入文件信息 | 显示创建导入导出任务时您选择的 **导入文件格式**、 **导入文件**、 **文件编码**、 **导入内容**、 **数据格式**、 **导入数据设置**、**任务错误处理**、**sys 租户账号配置** 和 **CSV 设置** 等信息。 |
| 导入对象信息 | 显示该任务中您选择的对象在导出或导入数据时的完成情况，包括  **对象名称**、 **对象类型**、**计划处理数量**、**实际处理数量** 和 **数据处理状态** 等信息。   |



### 任务日志 

单击操作列中的 **查看** 按钮弹出目标任务的任务详情面板，在面板的右上角单击 **任务日志** 标签查看任务的全部日志和告警日志。


| 信息项  |                            说明                             |
|------|-----------------------------------------------------------|
| 全部日志 | 全部日志显示任务的 **INFO** 、 **ERROR** 和 **WARN** 日志等全量信息。        |
| 告警日志 | 告警日志单独显示任务的 **ERROR** 和 **WARN** 日志。当任务失败时，可通过告警日志查看错误信息。 |

同时，工具栏提供了以下功能键：

| 功能 |                            说明                           |
|------|-----------------------------------------------------------|
| 查找 | 单击该按钮查找日志信息。        |
| 下载 | 单击该按钮下载日志信息。 |
| 复制 | 单击该按钮复制日志信息。 |