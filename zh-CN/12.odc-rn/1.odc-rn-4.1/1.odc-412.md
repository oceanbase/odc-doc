# ODC V4.1.2

本次 3 月发版的 OceanBase 开发者中心（OceanBase Developer Center，ODC）V4.1.2 主要新增批量创建个人连接/公共连接/用户和客户端版 ODC 中提示信息收集列表，同时对 SQL 窗口交互、SQL 执行、PL 对象、结果集编辑、表和视图对象的数据展示和影子表等功能进行了优化。

## 版本信息 

* **当前版本：** V4.1.2

* **前置版本：** V4.1.1

* **发版时间：** 2023 年 03 月 16 日

* **支持的升级路径：** 对于 ODC V2.0.0 及之后版本，均可直接升级至本版本。




## 支持的 OceanBase 数据库版本

OceanBase 开发者中心 V4.1.0 版本支持下述版本的 OceanBase 数据库。

* ODC 通用功能支持 OceanBase 数据库版本

  * OceanBase V1.4.x（主流版 V1.4.7）
  
  * OceanBase V2.0.x
  
  * OceanBase V2.1.x
  
  * OceanBase V2.2.x（主流版 V2.2.7）
  
  * OceanBase V3.1.x（主流版 V3.1.2）
  
  * OceanBase V3.2.x（主流版 V3.2.4）

  * OceanBase V4.0.0

  * OceanBase V4.1.0
  
  * OceanBase 社区版
  

  

* ODC PL 功能支持 OceanBase 数据库版本

  * PL 对象（函数/存储过程/程序包）编译、PL 对象（函数/存储过程）调试和匿名块调试：支持 V2.2.7、V3.0.x 及之后版本，推荐 OceanBase V3.2.3 BP4 及之后版本体验更友好的调试能力。
  
  * PL 对象（函数/存储过程/程序包）运行和匿名块运行：支持 V2.0.x 及之后版本。


## 功能变更

* 连接管理
  
  * 新增批量导入个人连接/公共连接功能，支持通过上传对应模板文件批量创建个人连接/公共连接。

* 管控协同
  
  * 新增批量导入用户功能，支持通过上传对应模板文件批量创建用户。

* SQL 窗口
  
  * 加宽 SQL 窗口编辑区域的横纵滚动条。

  * SQL 窗口会话默认模式从共享 Session 调整为独立 Session

  * 执行 SQL 语句前，支持选择是否开启 **获取结果集列信息**。表列数量较多时关闭该选项，将不查询获取列注释及可编辑的列信息，以降低 SQL 执行耗时。

  * 编辑结果集时，调整 CLOB 大字段的大小限制（文本 2 MB 内、十六进制 200 KB 内和图片 20 MB 内）。
  
  * 编辑结果集时，支持指定行输出到剪切板。

  * 结果集的状态栏中支持显示字段类型和字段备注等信息。

* 数据库对象

  * OceanBase 数据库低于 V3.2.4 版本时，PL 调试页面中会提示升级 OceanBase 数据库版本。

  * 调试 PL 对象时，入参中包含 RECORD/COLLECTION 等复杂数据类型，支持通过调试窗口声明参数。

  * 优化 PL 对象创建中的交互的界面。
  
  * 查看表数据时，当鼠标定位在某列（列值、列头）时，状态栏支持展示字段类型和字段备注等信息。
  
  * 视图数据页签中，支持设置在页面中展示的行数。 

* 导入导出
  
  * 导入 CSV 单表时支持跳过首行。

  * 仅导出结构时支持合并 DDL 为一个 SQL 文件，并按照外键依赖顺序排序。

  * 导出时，支持设置单个文件的大小限制，包括无限制、64 MB、512 MB、1024 MB 和 2048 MB。

  * 导出日期类型 SQL 语句使用 TO_DATE, TO_TIMESTAMP 函数。

* 第三方集成

  * Web 版 ODC 同时支持账密登录和第三方登录。

  * 单点登录（SSO）支持 OIDC。

* 其它模块

  * 客户端版 ODC 新增信息收集列表，以收集 ODC 部分功能模块的使用频率。

  * 错误信息中支持展示请求 ID。

  * 新建影子表同步时，支持通过新增的全选框全选源表。

## 问题修复 

* 数据库对象

  * OceanBase V4.0.0 及之后版本，查看公用同义词时详情时间显示错误。

  * 创建程序包后，生成的 DDL 在某些场景下出错。

  * OceanBase Oracle V4.0.0 及之后版本，表对象 NUMBER 数据类型的 precision 和 scale 展示错误。

  * 表名以 : 结尾时，左侧对象树展开表会报错。

  * 优化表对象不存在时的错误信息。

  * 运行包含 VARCHAR2 数据类型 OUT 参数的 PL 对象时报错。

  * 程序包列表中，右键编译包体无结果返回。

* SQL 执行

  * BLOB/CLOB 列为空字符串时，查看该行数据报错。

  * PL 对象中包含 sum(case when then else end) as 时会导致分句错误。

  * 存储过程执行成功，但 SQL 检查报语法错误。

  * 删除结果集中的行数据时，SQL 检查提示风险。

  * 使用 OceanBase V4.1.0 查看执行计划时报错。

  * `from` 子句中包含 `pivot/unpivot` 时执行 SQL 失败。

  * 执行包含 `Q` 转义字符的 SQL 语句时报错。

  * PL/SQL 语句中包含除号 `/` 且分隔符为 `/` 时，分句会报错导致执行失败。


* 导入导出

  * 导出数据中，空值为 `\E`。

  * 导出对象过多时报错。

  * 取消执行导入导出任务时，查看日志报错。

  * 导出时产生的临时文件未删除，占用大量磁盘空间。

  * 左连接时，连接左表中包含空值时，导出结果集报错。

  * 导入时，设置的批量提交数量不生效。


* 管控协同

  * 用户可在管控台查看无访问权限的的连接信息。

  * 可对无管理权限的资源进行新建/编辑。

  * 对任务列表的加载时间进行了优化。

  * 少数场景下，任务会自动重试。

  * 资源名称未校验是否合法。


* 数据脱敏

  * 使用字符替换规则时，脱敏结果会多出一个 `null` 字符串。

  * 使用字符替换自定义分段时，错误地添加了分隔符。


* SQL 计划

  * 删除连接后，连接关联的 SQL 计划无法继续执行。

* 工具

  * Windows 系统下，客户端版 ODC 的命令行工具中文可能乱码。

  * 多节点部署场景下，命令行窗口中执行 `source` 命令无法引用文件。

* 安装部署

  * 启动 Docker 时设置 4 GB 内存大小导致启动失败。


## 已知问题

* 客户端版 ODC 不支持安装在中文目录名中。

* 导出包含虚拟列的表时，导出的数据文件和内容显示异常。

* Web 版 ODC 中，结构或数据的导入量上限为 2GB，超限文件无法上传。

* Web 版 ODC 中，结构或数据的导出量上限为 2GB，超限会导致最终导出数据不完整。

* 导出任务详情中，导出对象的数据总记录数依赖 OceanBase 数据库视图，并非精准值。

* 需设置 `ob_enable_trace_log` 参数为 `on`，否则只显示首次执行的 SQL 的执行计划。