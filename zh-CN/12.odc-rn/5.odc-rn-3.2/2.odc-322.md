ODC V3.2.2 
===============================

#RNDate#2021-12-08

本次 12 月发版的 OceanBase 开发者中心（OceanBase Developer Center，ODC）V3.2.2 主要对连接管理、SQL 窗口、PL 调试和数据库对象等功能进行了更新。本次迭代所更新的模块与功能如下所示。

版本信息 
-------------------------

* 当前版本：V3.2.2

  

* 前置版本：V3.2.1

  

* 发版时间：2021 年 12 月 8 日

  

* 对于 ODC V2.0.0 及之后版本，均可直接升级至本版本。

  




支持的 OceanBase 数据库版本 
----------------------------------------

OceanBase 开发者中心 V3.2.2 版本支持下述版本的 OceanBase 数据库。

* OceanBase V1.4.x

  

* OceanBase V2.0.x

  

* OceanBase V2.1.x

  

* OceanBase V2.2.x

  

* OceanBase V3.1.x

  

* OceanBase V3.2.x

  




功能变更 
-------------------------

* SQL 窗口：

  * SQL 执行重新实现，API 异步化，连接更稳定，连接断开时支持自动重连，长耗时语句执行网络更友好；
    
  
  * SQL 窗口支持 PL 代码块智能识别；

    
  
  * 执行记录支持清理；

    
  
  * 支持查询账号跨库查询时补全表名；

    
  
  * 优化格式化能力，格式化最长时间控制在 2s 内。

    
  

  

* 结果集：


  * 仅当执行 SQL 为查询时，展示结果集 TAB，其它 SQL 类型的执行结果在日志 TAB 中展示；
    
  
  * 结果集支持多行多列选择；
    
  
  * 结果集支持冻结行；

    
  
  * 结果集列模式支持查看列备注；

    
  
  * 支持直接导出 EXCEL 格式；

    
  
  * 支持导出 CSV 格式时，自定义文本分隔选项；

    
  
  * 支持大字段查看器。

    
  

  

* 首页管理：

  * 连接列表支持按集群、租户筛选；

    
  
  * 筛选组件支持按空条件筛选；

    
  
  * WEB 版个人信息详情，原姓名调整为账号展示。

    
  

  

* 管控台：

  * 公共连接列表支持按集群、租户筛选，支持 "空" 筛选；

    
  
  * 公共连接列表支持复制新建连接。

    
  

  

* 连接管理：

  * MySQL 模式下，新建连接时如默认数据库不填写，默认库由 MySQL 调整为 information_schema；

    
  
  * 连接列表按照集群、租户进行筛选，支持 "空" 筛选。

    
  

  

* 表结构：


  * 表结构支持外键管理；
    
  
  * 字段名支持搜索。

    
  

  

* PL 对象：

  * 编译时，如存在告警信息，在编译结果中展示具体的告警信息；

    
  
  * PL 对象无效，hover 对象名可展示导致该对象无效的具体原因。

    
  

  

* PL 调试：

  * PL 调试重新实现，调试更顺滑，出现问题时可查看明确的错误信息；
    
  
  * 程序包支持子程序并行调试；

    
  
  * 支持通过 OBProxy 进行调试。

    
  

  

* 异步执行：

  * 异步执行中，允许用户输入的变更内容上调至 50w 个字符。

    
  

  

* 安全

  * 管理员重置用户密码后，用户需修改密码后才可激活使用；

    
  
  * 用户激活账号时，需设置与原密码不同的密码。

    
  

  

* 其它：

  * 适配 OceanBase-CE 版本。

    
  

  




问题修复 
-------------------------

* 连接管理

  * 连接管理页面由最小化切换为最大化时，分页显示异常；

    
  
  * 连接因 server 端阻塞而无法退出，导致超时设置不生效；

    
  
  * SQL 执行终止偶发失败；

    
  
  * 公共连接只读模式下，已开放部分写操作入口。

    
  

  

* 数据库对象管理

  * 创建分区不能立刻回显；

    
  
  * 外键约束列在跨 schema 场景下无法展现；

    
  
  * Oracle 模式下，创建已存在的表失败，同名表可能会被删除；

    
  
  * Oracle 模式下，WITH TIME ZONE 数据类型查看错误；

    
  
  * MySQL 模式下，bit 类型字段值展示错误；

    
  
  * MySQL 模式下，列的默认值未识别 NOW()/UTC_TIMESTAMP/LOCALTIME 等时间函数；

    
  
  * MySQL 模式下，oceanbase/information_schema 下的视图 DDL 不展示；

    
  
  * 包含 BODY 的类型内成员结构未展开；

    
  
  * 部分页面会出现表格抖动。

    
  

  

* SQL/PL 执行

  * 超长 SQL（超过 30000 个字符）执行无响应；

    
  
  * 切换 schema 后，运行存储过程报错（升级驱动修复）。

    
  

  

* 异步执行

  * 异步执行上传带 BOM 头的文件执行报错；

    
  
  * 多线程编程概率性问题导致异步执行任务日志有时无法查看；

    
  
  * 切换 schema 后执行异步任务，schema 切换不生效；

    
  
  * 服务重启时，异步执行任务自动加载失败。

    
  

  

* 导入导出

  * MySQL 模式下，查询包含列别名时结果集导出失败；

    
  
  * 导出任务时，"空字符串转为空值"选项不生效。

    
  

  

* 命令行窗口

  * 在命令行窗口粘贴内容超过 8k 时，连接断开；

    
  
  * Windows 桌面版命令行窗口无法打开。

    
  

  

* 模拟数据

  * 模拟数据当连接密码为空时无法启动。

    
  

  

* 高可用部署

  * 高可用部署下，SQL 执行超过 1 分钟报连接已断开。

    
  

  

* 其它模块

  * 未激活用户在用户密码输入错误时，同样会进入激活页面；

    
  
  * 拥有管控台权限的用户，进入管控台后可编辑和停用自己的账号；

    
  
  * 管理员重置密码后，无修改密码激活引导过程；

    
  
  * odc-server 频繁打印 Druid 连接池错误日志。

    
  

  




已知问题 
-------------------------

* X86 版 OBServer 中不支持带输出参数的函数调试；

  

* ARM 版 OBServer 中的 PL 对象不支持调试；

  

* 包含复杂类型 (cursor,record,collection)、用户自定义类型的 PL 对象不支持调试；

  

* 包含 CLOB 变量的 PL，对其进行调试会导致 OBServer core；

  

* 结构或数据的导出量上限为 2G，超限会导致最终导出数据不完整；

  

* 导出任务详情中，导出对象的数据总记录数依赖 OceanBase 数据库视图，并非精准值；

  

* 结构或数据的导入量上限为 2G，超限文件无法上传；

  

* 需设置 `ob_enable_trace_log` 参数为 `on`，否则只显示首次执行的 SQL 的执行计划。