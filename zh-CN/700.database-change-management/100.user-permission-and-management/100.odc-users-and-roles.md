# 用户和角色

## 背景信息

OceanBase 开发者中心（OceanBase Developer Center，ODC）支持拥有创建用户权限的用户添加用户，并通过角色授予相关权限。被添加的用户可以通过配置的账号密码登录 ODC。

角色是为用户赋予各种权限的一种对象，为多种权限的集合，使用角色可将一组具有相同权限的用户组织在一起。为便于用户赋予并管理其在 ODC 所拥有的权限，可自定义角色并将角色赋予用户。

本文档旨在介绍如何创建和管理 ODC 用户和角色。

## 原理介绍

用户、角色、项目、系统权限之间的关系如下：

![1.20](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/1000.user-permission-and-management/1.odc-users-and-roles/1.20.png)

1. 拥有创建角色权限的用户可以在 **用户权限** 中创建角色。

2. 拥有创建用户权限的用户可以在 **用户权限** 中添加用户，并为其指定角色权限。

3. 拥有审批流程操作权限的用户可以在 **安全规范** 中创建审批流程时，选择项目角色作为审批节点。

4. 拥有风险等级操作权限的用户可以在 **安全规范** 中编辑风险等级时，选择创建的审批流程。

5. 拥有风险识别规则操作权限的用户可以在 **安全规范** 中设置风险等级对应的风险识别规则。


## 注意事项

- ODC 中已内置一个管理员用户 **admin**，该账户被自动设置为管理员角色 **system_admin** ，所以该账户可进行系统有关的所有操作且默认可访问所有的公共资源，该账户不支持被编辑、删除和停用。

- 角色是为用户赋予各种权限的一种对象，为多种权限的集合，使用角色可将一组具有相同权限的用户组织在一起。为便于用户赋予并管理其在 OceanBase 开发者中心（OceanBase Developer Center，ODC）所拥有的权限，可自定义角色并将角色赋予用户。

## 用户管理

### 新建用户

#### 新建单个用户

示例：管理员在 ODC 中创建用户名 ODCUSER1，并为其授予 system_admin 角色权限。

1. 登录 Web 版 ODC 后，在项目协同窗口的左侧导航栏中，单击 **用户权限**。

   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/1.png)

2. 如上图所示，在 **用户权限** 的 **用户** 页签中，单击 **新建用户**。

3. 在弹出的 **新建用户** 页面中，指定 **用户信息**。

   ![2](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/2.png)

   a. 用户信息包含以下三部分：

      |     信息项     |  说明  |
      |-------------|--------------|
      | 账号        | 指定用于登录 ODC 的账户信息。账号是必填项且不可重复，支持英文、数字、下划线和特殊字符的组合（即：._+@#$%），长度为 4\~48 位字符。  |
      | 姓名        | 指定登录后在 ODC 中用于显示的姓名信息。姓名是必填项，长度不超过 110 位字符。 |
      | 密码        | 指定用于登录 ODC 的密码信息。密码是必填项，其中至少包含 2 位数字、2 位大写字母、2 位小写字母和 2 位特殊字（即：._+@#$%），长度为 8\~32 位字符。单击文本框后的 **随机密码** 按钮 ODC 将为您自动生成一串随机密码。<main id="notice" type='explain'><h4>说明</h4><p>管理员新建用户或修改用户密码后，用户首次登录时，会提示修改用户密码，以加固密码并预防密码泄露。</p></main> |

   b. ODC 支持批量创建用户，可单击 **+ 添加用户** 按钮，指定多个用户信息。

2. 指定 **账号状态**。

   新创建的账户默认为 **启用** 状态，可手动选择 **停用**，停用的账户将不能进行登录操作。

3. 为新建用户指定 **角色** 。

   此选项为选填项，可以为用户赋予多个角色。单击文本框，弹出的下拉列表中会显示组织中已创建的角色，在列表中选择需为当前创建的所有用户赋予的角色。若无已创建的角色，请先至角色管理创建角色。

4. 指定 **备注** 信息。

   此选项为选填项。在文本框中输入备注信息，非必填项，长度不超过 140 位字符。

5. 单击 **新建**，提交新建用户信息。

6. 保存用户信息。

   ![3](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/3.png)

   新建用户成功后，在弹出的 **用户创建成功** 弹窗中会显示本次新建的所有用户信息。可通过单击弹窗中的 **复制用户信息** 和 **下载用户信息** 按钮将新建的用户信息保存至本地。

   在批量创建用户的场景中，此操作有助于快速保存所有新建用户信息。

7. 在 **用户** 列表中查看导入的用户信息。

   ![4](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/4.png)

#### 批量导入用户

ODC V4.1.2 及之后的版本支持通过上传配置文件批量导入用户。操作步骤如下：

1. 在 **用户权限** 的 **用户** 页签中，单击 **批量导入**。

   ![5](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/5.png)

2. 在弹出的 **批量导入** 面板中单击 **下载模板**，填写需要导入的用户信息：

   ![6](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/6.png)

   |     信息项     |  说明  |
   |-------------|-------------------------|
   | 账号        | 必填项且不可重复。指定用于登录 ODC 的账户信息。账号支持英文、数字、下划线和特殊字符的组合（即：._+@#$%），长度为 4~48 位字符。  |
   | 姓名        | 必填项。指定登录后在 ODC 中用于显示的姓名信息。姓名长度不超过 110 个字符。 |
   | 密码        | 必填项。指定用于登录 ODC 的密码信息。密码至少包含 2 位数字、2 位大写字母、2 位小写字母和 2 位特殊字（即：._+@#$%），长度为 8~32 位字符。 |
   |  账号状态       | 必填项。选择 true/false。 |
   |   角色      | 非必填项。指定 ODC 中已创建的角色名称，多个角色名称须用英文逗号分隔。 |
   |   备注      | 非必填项。 |

   ![7](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/7.png)

3. 单击 **批量导入** 面板中的文件池进入文件资源管理器以选择需要导入的文件，或者直接将文件拖入文件池中以完成文件上传。

4. 单击 **导入**，完成批量导入用户信息，并可以在用户列表中查看导入的用户信息。

   ![8](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/8.png)

### 用户列表 

如上图所示，用户列表基本信息如下。

| 信息项  |  说明  |
|--------|--------|
| 姓名   | 显示为用户执行的姓名信息。 |
| 账号   | 显示为用户指定的账号信息。|
| 角色   | 显示角色信息。 |
| 状态   | 显示用户状态为 **启用** 或 **停用** 。 单击筛选图标![筛选](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/icon/filter.jpg)，可筛选状态。 |
| 更新时间 | 显示用户信息最近一次被更新的时间。 单击 **更新时间** ，可升序或降序。 |
| 登录时间 | 显示用户最近一次登录 ODC 的时间。 单击 **登录时间** ，可升序或降序。|
| 操作   | 显示 **查看** 、 **编辑** 和 **停用/启用** 功能键。可单击 **停用/启用** 按钮直接修改用户的状态。<main id="notice" type='explain'><h4>说明</h4><p>当前登录用户不可编辑和停用自己的账号。</p></main>|

### 查看用户 

![9](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/9.png)

1. 在用户列表中，单击操作列中 **查看** 按钮。

2. 在弹出的 **用户信息** 面板中可以查看 **用户详情** 和 **相关资源**。

| 信息项  | 说明|
|--------|---------|
| 用户详情 | <ul><li> 创建信息：显示 **账号** 、 **姓名** 、 **密码** 、 **角色** 和 **备注** 等创建用户时您指定的信息。其中密码是加密显示，并提供 **重置密码** 按钮以供修改用户的登录密码。</li><li> 操作信息：显示 **创建人** 、 **创建时间** 、 **更新时间** 和 **登录时间** 等信息。</li><li> 删除用户：单击页签中的 **删除用户** 按钮将删除当前用户，删除用户后，该账号将无法登录 ODC 且无法恢复其相关的数据。</li></ul>    |
| 相关资源 | 显示当前用户可访问的数据源名称及其权限信息。|
| 编辑   | 在 **用户信息** 面板中，单击右下角的 **编辑** 按钮可进入 **编辑用户** 面板。 |

### 编辑用户 

![10](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/user/10.png)

1. 在用户列表中，单击操作列中 **编辑** 按钮。

2. **编辑用户** 面板中会显示您在新建用户时指定的所有信息项。其中在用户被创建后不可修改 **账户** ，可修改 **姓名** 、 **账号状态** 、 **角色** 和 **备注** 等信息，可在查看用户详情页面时修改 **密码** 。

## 角色管理

### 新建角色

示例：管理员在 ODC 中创建角色 odc_project，该角色拥有编辑数据源 mysql_4.2.0 和管理用户 ODCUSER1 的权限。

1. 在项目协同窗口的左侧导航栏中，单击 **用户权限** > **角色** > **新建角色**。

   ![11](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/1000.user-permission-and-management/1.odc-users-and-roles/11.png)

2. 在弹出的 **新建角色** 面板中填写或选择以下信息。

   ![12](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/1000.user-permission-and-management/1.odc-users-and-roles/12.png)

   |  权限类型  |功能描述|
   |--------|------------|
   |角色名称|指定新建角色的名称，角色名称为必填项，长度不超过 48 位字符。|
   |角色状态|新创建的角色默认为 **启用** 状态，用户可以手动选择 **停用**，被停用的角色其权限将不生效。|
   |权限类型|选择要为当前角色指定的权限类型。<br>当前 ODC 支持指定资源管理权限和系统操作权限，勾选需要设置的权限后，下方会出现 **权限设置** 项。创建角色时，必须为该角色指定至少一种权限类型并进行设置。<ul><li>资源管理权限：包括数据源、项目、角色、用户的管理权限（新建/管理/编辑/查看）。</li><li>系统操作权限：包括操作记录、自动授权、审批流程、审批流程、风险识别规则、开发规范、系统集成的操作权限（查看/操作）。</li></ul>|
   |备注|在文本框中输入备注信息，非必填项，长度不超过 140 位字符。|

3. 指定上述信息后，单击面板右下角的 **新建** 按钮以完成角色的新建。

4. 创建完成后，可在角色列表中查看创建的角色。

   ![13](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/1000.user-permission-and-management/1.odc-users-and-roles/13.png)

### 角色列表 

如上图所示，角色列表基本信息如下。

| 信息项  | 说明  |
|--------|------------|
| 角色名称 | 显示为角色的名称。  |
| 权限类型 | 显示为角色指定的权限类型。   |
| 更新时间 | 显示角色信息最近一次更新的时间。  |
| 启用状态   | 显示角色状态为启用或者停用。 |
| 操作   | 支持 **查看** 和 **编辑** 角色。 |

### 查看角色

1. 在角色列表中，单击操作列中 **查看** 按钮。

2. 在弹出的 **角色信息** 面板中可以查看 **角色详情** 和 **相关用户**。

   ![14](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/1000.user-permission-and-management/1.odc-users-and-roles/14.png)  

   | 信息项  | 说明 |
   |--------|----------|
   | 角色详情 | <ul><li> 创建信息：显示 **角色名称** 、 **权限类型** 和 **备注** 等创建角色时所指定的信息。 </li><li> 操作信息：显示 **创建人** 、 **创建时间** 和 **更新时间** 等信息。</li><li> 删除角色：单击页签中的 **删除角色** 按钮将删除当前角色，删除角色后无法恢复其相关的数据，且引用该角色的用户权限被同步回收，但不影响用户登录。</li></ul>    |
   | 相关用户 | **相关用户** 页签中显示被授予当前角色的用户列表，列表中会显示用户的 **姓名** 、 **角色** 和 **状态** 等信息。  |  

3. 在 **角色信息** 面板中，单击右下角的 **编辑** 按钮进入 **编辑角色** 面板。  

4. 单击 **复制角色** 按钮进入 **新建角色** 面板，面板中均会自动填充当前角色的信息。

### 编辑角色

1. 在角色列表中，单击操作列中 **编辑** 按钮。

2. 修改角色信息。

2. 修改完成后，在 **编辑角色** 面板右下角，单击 **保存** 按钮保存编辑。


## 相关文档

- [自动授权](../100.user-permission-and-management/200.manage-automatic-authorization-rules.md)
