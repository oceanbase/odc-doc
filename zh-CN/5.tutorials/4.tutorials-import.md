如何导入数据 
===========================

本篇教程介绍在 OceanBase 开发者中心（OceanBase Developer Center，ODC）中进行数据批量导入操作的详细步骤。

背景信息 
-------------------------

为使数据库开发者更方便的维护数据库内的数据，ODC 提供批量导入导出和单表导入导出功能。通过批量导入导出您可以批量选择数据库中的对象以导入或导出其中的数据或结构，通过单表导入导出，您可以导出目标表中的数据。目前 ODC 支持的导出数据格式有 CSV 格式和 SQL 格式，支持的导入文件格式有 ZIP 压缩文件、SQL 文件（批量导入）和 CSV 文件（单表导入）。

创建导入或导出任务后，可进入任务中心下载导出文件和查看任务详情和日志等信息。

本教程以批量导入为例，介绍如何在 ODC 中导入数据的详细步骤。

前提条件 
-------------------------

* 确认字符集。OceanBase V2.2.30 及之后版本支持字符编码 UTF8、GBK、GB18030 和 UTF16 等。OceanBase V2.2.30 版本之前仅支持字符编码 UTF8。ODC 目前导出文件的编码为 UTF-8，暂不支持修改。

  

* 确认连接方式。在 ODC V2.2.1 及之前的低版本中使用导入导出功能时必须通过 OBProxy 连接至目标实例，直连时 ODC 不支持导入导出功能。

  

* 配置 root@sys 账户。自 ODC V2.4.1 之后版本，可选择配置 sys 租户账号以提升导出导入速度。同时，导出时如已勾选表和视图之外的其它对象，必须配置该项以使用 sys 租户账号进行导出。

  




操作步骤 
-------------------------

1. 进入 **批量导入** 面板。

   进入连接后，单击上方导航栏中的 **工具** 按钮，在下拉列表中选择 **导入** 后，弹出 **批量导入** 面板。
   

2. 指定 **任务名** 。

   **导入设置** 面板中，ODC 会自动生成默认的任务名，格式为连接名_模式名_日期，同时可在文本框中修改自动生成的任务名。
   

3. 选择 **导入格式** 。

   目前 ODC 支持的导入格式有 ZIP 压缩文件、SQL 文件（批量导入）和 CSV 文件（单表导入）。其中 SQL 格式和 CSV 格式是 OceanBase 导入导出工具特有的格式。具体格式信息，请参见本手册中的 **导出导入格式** (《用户指南》![符号](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5112176361/p351955.jpg) 使用工具![符号](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5112176361/p351957.jpg) 数据导出与导入)。本教程选择导入格式为 **ZIP 压缩文件** 。
   

4. 上传 **导入文件** 。

   单击文件池进入文件资源管理器选择要导入的文件，或者直接将文件拖入文件池中以完成文件上传。上传的文件格式需与所选的导入文件格式相同，ZIP 压缩文件支持上传 .zip 结尾的文件。SQL 文件支持上传 .sql 文件。上传的文件的格式需与步骤 3 中选择的 **导入格式** 相同。
   

5. 选择 **文件编码** 。

   ODC 目前支持 **ASCII** 、 **ISO-8859-1** 、 **GB2312** 、 **GBK** 、 **GB18030** 、 **Unicode（UTF-8）** 、 **Unicode（UTF-16）** 、 **Unicode（UTF-32）** 和 **BIG5** 等编码格式。需在 **文件编码** 下拉框中选择所需的编码格式。
   

6. 选择 **导入内容** 。

   ODC 目前支持 **导入结构和内容** 、 **仅导入数据** 和 **仅导入结构** 三种方式 **。** 

   当 **导入格式** 为 ZIP 压缩文件时需指定该项。导入结构是指运行导入文件中的对象定义语句，导入后会在数据库中创建新的对象，导入数据是向指定对象中导入数据文件中的数据。本教程选择导入内容为 **导入结构和内容** 。
   

7. 选择 **数据格式** 。

   当 **导入格式** 为 ZIP 压缩文件时需指定该项。ODC 目前支持导入 **CSV 格式** 和 **SQL 格式** 的数据。具体格式信息，请参见本手册中的 **导出导入格式** (《用户指南》![符号](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5112176361/p351955.jpg) 使用工具![符号](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/5112176361/p351957.jpg) 数据导出与导入)。本教程选择数据格式为 **CSV 格式** 。
   

8.  进行 **导入数据设置。** 

    当 **导入格式** 为 ZIP 压缩文件且 **导入内容** 为仅导入结构时无需进行导入数据设置。该项包含以下设置项：
    * **导入前清空数据** ：勾选该项后，导入数据时将首先清空目标对象中原有的数据。

      
    
    * **批量提交数量** ：单击 **导入** **数据设置** 标签后的 **高级** 按钮，在弹出的列表中可指定该项。通过指定批量提交数量，可在导入文件中导入指定数量数据时添加一句 `COMMIT` 命令。

      
    
    * **跳过的数据类型** ：单击 **导** **入** **数据设置** 标签后的 **高级** 按钮，在弹出的列表中可指定该项。您可以通过该项指定导入数据时要跳过的数据类型。MySQL 和 Oracle 下可跳过的类型不同，支持多选。

      
    

    

9.  进行 **导入结构设置** 。

    当 **导入内容** 为仅导入数据时，该项不可被指定。在该项下选择当对象结构已存在时的操作。选择 **跳过** 操作则在导入时跳过导入文件中的结构定义语句直接导入数据，该项会保留对象中的原数据。选择 **替换** 操作时则执行导入文件中的结构定义语句以重新创建并替换原对象，该项会清空对象中的原数据。
    

10. 选择 **任务错误处理** 方式。

    ODC 提供 **停止任务** 和 **忽略错误继续任务** 两种错误处理方式。需在 **任务错误处理** 标签下选择所需的处理方式。
    

11. 进行 **sys 租户账号配置** 。

    在该项下选择是否 **使用 sys 租户账号提升导入速度** 。勾选后在弹出的 **账户** 和 **密码** 文本框中填写 sys 账户和对应的密码。设置好该项后会使用 sys 租户的权限进行导入，可提升导入的速度。
    

12. 生成导入任务。

    单击面板右下角的 **导入** 按钮以生成导出任务。

    任务成功生成后 ODC 会自动跳转至任务中心，在任务中心可查看导入任务的运行状况，任务完成后可查看任务详情和日志等信息。
    



