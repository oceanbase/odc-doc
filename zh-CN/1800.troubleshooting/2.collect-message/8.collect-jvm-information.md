收集 JVM 运行时信息 
=================================

本文档旨在介绍如何收集 JVM 运行时信息。

**步骤 1：** 进入 ODC Docker。 
-----------------------------------------

```shell
#查看 ODC Docker 名称
docker ps | grep odc

#进入 ODC Docker，假设 ODC Docker 名称为 odc
docker exec -it odc sh
```



**步骤 2：使用 jps 获取进程号。** 
---------------------------------------

命令：

```shell
jps | grep odc
```

{#t4xvgg}

返回示例：{#f2a81010fa00d}

```shell
67255 odc-web-starter-3.3.0-SNAPSHOT-executable.jar
```

{#qkxukh}

其中，`62277` 为进程号。{#0df6e080fa5sb}

**步骤 3：抓取 thread dump。** 
-----------------------------------------

命令：

```shell
jstack ${ODC_PID} > ${THREAD_DUMP_FILE_NAME}
```

{#rzgcov}

命令示例：{#3181ff80favzc}

```shell
jstack 67255 > /home/admin/odcthreaddump.txt
```

{#i7sgus}

**步骤 4：抓取 heap dump。** 
---------------------------------------

命令：

```shell
jmap -dump:live,format=b,file=${HEAP_DUMP_FILE_NAME} ${ODC_PID}
```

{#1gl3az}

命令示例：{#377f3380fayl5}

```shell
jmap -dump:live,format=b,file=/home/admin/odcdump.hprof 67255
```

{#ch6rfg}

**步骤 5：拷贝 dump 文件。** 
-------------------------------------

步骤 3 中的`/home/admin/odcthreaddump.txt`和步骤 4 中的`/home/admin/odcdump.hprof`即为 dump 文件。
