# SQL 编辑和执行

本文档旨在介绍用户如何在 SQL 窗口中编辑和执行 SQL 语句。

## 背景信息

ODC SQL 窗口提供了用于处理数据的用户界面。在 SQL 窗口中，用户可以对数据进行排序、过滤、添加、编辑和删除以及执行数据库对象。

本文档以创建表为例，介绍如何在 SQL 窗口中创建表 employee 到数据库 odc_test 中。

<main id="notice" type='explain'>
   <h4>说明</h4>
   <p>文中所使用的均为示例数据，您可根据实际情况对数据进行替换。</p>
</main>

## SQL 编辑

<main id="notice" type='explain'>
   <h4>说明</h4>
   <p>如果用户无表权限，可以通过 <strong>工单</strong> 中的 <strong>申请表权限</strong> 查询/导出/变更表。</p>
</main>

1. 在项目 **odc_4.2.0** 中单击 **登录数据库**，进入 SQL 开发窗口。

   ![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/1.png)

2. 在 SQL 窗口中，编辑 SQL 语句以创建表 `employee`。

   ![2](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/2.png)

   ```sql
   CREATE TABLE odc_test.employee (emp_no int(120) COMMENT '员工工号' NOT NULL, birthday date COMMENT '员工生日' NULL,name varchar(120) COMMENT '员工姓名' NULL,CONSTRAINT cons_employee_empno PRIMARY KEY (emp_no)) DEFAULT CHARSET = utf8mb4    COLLATE = utf8mb4_general_ci;
   ```

   语法格式：

   ```sql
   CREATE TABLE table_name (column_name column_type, column_name column_type,.......);
   ```

   参数说明：

   | 参数                      | 说明                                     |
   |-------------------------|----------------------------------------|
   | CREATE TABLE            | 用于创建给定名称的表，必须拥有表 CREATE 的权限。           |
   | table_name              | 创建表的名称，表名称必须符合标识符命名规则。                 |
   | column_name column_type | 指定数据表中每个列（字段）的名称和数据类型，如果创建多个列，需要用逗号隔开。 |

   - 如上图所示，单击 SQL 窗口中的 ![select a database](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/select%20a%20database.png) 支持切换数据库。

   - SQL 窗口工具栏详情请参见 [常用功能简介](../1350.feature-details.md)。

## SQL 执行

1. SQL 语句编辑完成后，在 SQL 窗口的工具栏中中单击 **运行 F8** 运行当前 SQL 窗口中所有的 SQL 语句。

   | 功能     | 说明  |
   |--------|------------------|
   |运行 F8|运行当前 SQL 窗口中所有的 SQL 语句。可以通过快捷键 F8 运行所有 SQL 语句。|
   |运行当前语句 F9|运行当前选中的所有 SQL 语句或当前光标所在行的 SQL 语句。可以通过快捷键 F9 或者 Ctrl+Enter (Windows)/Command+Enter（MacOS） 运行当前语句。|
   |终止|终止正在运行的语句。|

   ![5](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/5.png)

2. 在结果页签中，可查看执行状态和执行结果。

   ![6](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/6.png)

## 查看数据

1. 在 SQL 开发窗口的左侧导航栏的 ![database](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/quickstart/webodc/sql%20editing/database.png) 中确认表 **employee** 是否创建到项目 **odc_4.2.0** > 数据库 **odc_test**。

   ![7](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/7.png)

   快捷键 <strong>Ctrl+J（Windows）/Command+J（MacOS）</strong> 支持根据关键字快速检索 ODC 当前项目/数据源中所有的库、表、视图、函数、触发器等对象。

   ![7.0](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/7.0.png)

2. 鼠标右键单击表 **employee** 或者在 SQL 窗口中编辑 SELECT 语句，查看表数据。

   ![8](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/8.png)

3. 单击 ![8.1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/8.1.png)，可以手动同步当前项目或者数据源下的表列等元信息。

4. 鼠标右键单击数据库名称 > **元数据同步**，可以手动同步当前数据库下表列等元信息。

   ![8.2](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/8.2.png)

## SQL 脚本

ODC 支持在 SQL 窗口和匿名块窗口中保存编辑的脚本，并可以在脚本页签中管理已保存的脚本。

### 保存脚本

在 SQL 窗口中，保存创建表 employee 的脚本。

| 信息项 | 示例值 |
| ------ | ------ |
|表名称|employee|
|脚本名称|create_employee|

1. 在 SQL 窗口中，单击工具栏中的保存脚本按钮。

  ![9](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/9.png)

2. 指定保存的脚本名称，并 **确认**。

   ![10](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/sql-development/sql%20editing%20and%20execution/10.png) 

### 管理脚本

1. 在 SQL 开发窗口的左侧导航栏中，单击 ![script](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/sql-development/sql%20editing%20and%20execution/%E8%84%9A%E6%9C%AC.png)，打开脚本管理页面。

   ![11](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/11.png)

2. 在 **脚本** 页面中，支持编辑/下载/删除/刷新已保存的脚本、复制已保存的脚本路径，以及上传本地磁盘中的脚本。

   ![12](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/12.png)

   <main id="notice" type='explain'>
      <h4>说明</h4>
      <ul>
      <li>单击脚本名称可以直接引用脚本内容到 SQL 窗口中。</li>
      <li>复制路径可以引用脚本内容到命令行窗口中。</li>
      </ul>
   </main>

## 代码片段

ODC 支持创建代码片段，用户可以在开发过程中查询已创建的代码片段，了解相关语句的具体用法。

### 创建代码片段

在代码片段页面，保存有关创建表 employee 的代码片段。

| 信息项 | 示例值 |
| ------ | ------ |
|表名称|employee|
|代码片段名称|create_table|

1. 在 SQL 开发窗口的左侧导航栏中，单击 ![script](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/sql-development/sql%20editing%20and%20execution/%E8%84%9A%E6%9C%AC.png)，并在打开的代码片段页面中单击 **+** 新建代码片段。

   ![13](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/420/sql-development/sql%20editing%20and%20execution/13.png)

2. 在 **新建代码片段** 页面中，指定代码片段信息后单击 **确定**。

   ![14](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/14.png) 

   <main id="notice" type='explain'>
      <h4>说明</h4>
      <p>ODC V4.2.3 及之后版本的代码片段长度调整至 64KB。</p>
   </main>

### 管理代码片段


在代码片段页面中，支持复制/编辑/删除/刷新已保存的代码片段。

![15](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/430/500.sql-development/100.sql-editing-and-execution/15.png)

## 相关文档

- [PL 编译和调试](../500.sql-development/200.pl-compile-and-debug.md)

- [命令行窗口](../500.sql-development/300.command-line-window.md)

- [结果编辑与导出](../500.sql-development/400.result-editing-and-exporting.md)

- [执行分析](../500.sql-development/500.perform-analysis.md)

- [生成测试数据](../500.sql-development/600.data-mocking.md)

- [数据库变更管理](../700.database-change-management/600.database-change.md)

- [分区管理](../800.data-Lifecycle-management/300.partition-scheme-management/310.manage-partition-scheme.md)

- [影子表同步](../700.database-change-management/800.shadow-table-synchronization.md)

- [无锁结构变更](../700.database-change-management/700.table-structure-change.md)
