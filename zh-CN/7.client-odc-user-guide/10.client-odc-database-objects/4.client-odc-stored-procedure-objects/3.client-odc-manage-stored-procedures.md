管理存储过程 
===========================



概述 
-----------------------

在 OceanBase 开发者中心（OceanBase Developer Center，ODC）首页单击连接名进入连接后，在左导航栏中单击 **存储过程** 标签可查看存储过程列表，在存储过程列表中显示当前连接的数据库中存在的存储过程对象。

在存储过程列表中，可查看该对象的 **结构树** 或右键目标对象以进行 **管理操作** 。或者，在存储过程列表中双击目标存储过程名进入 **存储过程管理页面** 。

结构树 
------------------------

如下图所示，在存储过程列表中，单击目标存储过程名左侧的下拉图标![下拉按钮2](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2334377361/p354912.jpg)，在弹出的下拉列表中会展示其结构树。

对象存储过程的结构树最深包含三层，右键单击结构树中不同层级中的项，提供对该项的操作键选项，具体操作请参见 **管理操作** 中的 **管理操作键表** ：

![Image 195](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%AE%A1%E7%90%86.png)

管理操作 
-------------------------

在存储过程列表中，存储过程对象名称默认支持按头字符升序排序。

### 快捷功能 

在结构树中的右上角提供以下功能：


| 操作键  |                                                    说明                                                    |
|------|----------------------------------------------------------------------------------------------------------|
| 新建   | 单击新建图标新建存储过程。                                                                                            |
| 筛选   | 单击筛选图标选择显示有效/无效存储过程。                                                                                     |
| 批量编译 | 单击批量编译图标对存储过程对象进行批量编译。包括： **编译全部对象** 和 **编译无效对象** 。<br> ![批量编译](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/%E6%89%B9%E9%87%8F%E7%BC%96%E8%AF%91.png) |
| 刷新   | 对当前存储过程对象进行一些管理操作后，刷新结构树以展示最新信息。 |



### 右键功能 

右键结构树中的目标项，在弹出的右键管理操作列表中，ODC 提供操作键选项以快速管理目标对象。下述为管理操作键表：


右键结构树中的目标项，在弹出的右键管理操作列表中，ODC 提供操作键选项以快速管理目标对象。

下述为管理操作键表：


| 操作键 |                                                                                                                                                                                                       说明                                                                                                                                                                                                        |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 查看  | 进入 **存储过程管理页面，** 全量查看当前存储过程的基本信息、参数和代码等信息。                                                                                                                                                                                                                                                                                                                                                                      |
| 新建  | 进入新建存储过程页面，根据步骤创建新的存储过程对象。                                                                                                                                                                                                                                                                                                                                                                                      |
| 编辑  | 在 **存储过程编辑页面** 中展示定义当前存储过程的语句，可以窗口中继续编辑该存储过程。                                                                                                                                                                                                                                                                                                                                                                   |
| 编译  | 编译目标存储过程。                                                                                                                                                                                                                                                                                                                                                                                                       |
| 调试  | 进入 **调试页面** 以对当前存储过程进行调试。                                                                                                                                                                                                                                                                                                                                                                                       |
| 运行  | 运行当前存储过程。                                                                                                                                                                                                                                                                                                                                                                                                       |
| 下载  | 下载存储过程对象的 SQL 文件。                                                                                                                                                                                                                                                                                                                                                                                                       |
| 删除  | 删除当前存储过程。                                                                                                                                                                                                                                                                                                                                                                                                       |
| 刷新  | 对当前存储过程对象进行管理操作后，刷新结构树以显示最新信息。<br> **说明**<br>  <li> 推荐升级至 OBServer V2.2.77 及之后版本（因 OBServer 部分版本存在 PL 调试类已知问题，可能导致 OBServer 不稳定）。</li>  <li> ODC V3.2.2 之前版本，通过 OBProxy 连接至目标实例时无法使用调试功能，请在 ODC 中直连到目标实例。</li>   <li> 自 ODC V3.2.2 及之后版本，ODC 支持通过 OBProxy 连接 OBServer 情况下进行 PL 调试。</li>     |



存储过程管理页面 
-----------------------------

![数据库对象-管理存储对象-参数](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7659061361/p326069.png)

在函数列表中，双击目标存储过程对象名进入存储过程管理页面。可在存储过程管理页面查看以下信息：


|  功能  |                                                                              说明                                                                              |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 基本信息 | 显示 **存储过程名称** 、 **创建人** 、 **创建时间** 和 **最近修改时间** 等信息。                                                                                                         |
| 参数   | 显示参数 **名称** 、 **模式** 、 **数据类型** 、 **长度** 和 **默认值** 等信息。单击![刷新](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7659061361/p326053.jpg)图标，可刷新参数。 |
| DDL  | 显示定义存储过程的脚本，同时提供 **编辑** 、 **查找** **、** **格式化** 和 **刷新** 功能键。 **说明**  单击 **编辑** 图标，会跳转至 PL 对象编辑窗口。                            |



存储过程编辑页面 
-----------------------------

在存储过程列表中右键目标项，在提供的操作键中单击 **编辑** 可进入存储过程编辑页面，在编辑页面的代码区会显示该存储过程的定义语句， 可继续进行编辑。同时，工具栏提供了以下功能键：


|   功能   |                                                                                                                     说明                                                                                                                     |
|--------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 确认修改   | 单击以更新本次修改。                                                                                                                                                                                                                                 |
| 编译     | 编译当前页面中的语句。 **说明**  * 编译过程中，如存在引用无效的外部对象时 对象名所在行高亮   * 编译完成后， **编译结果** 中会显示编译状态（如存在告警，会显示告警详情）。                         |
| 运行     | 单击该按钮![运行](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7267628361/p358390.jpg)运行代码区中的语句。                                                                                                                                  |
| 调试     | 单击该按钮![调试](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7267628361/p358392.jpg)进入调试模式，并对代码区内的 PL/SQL 对象进行调试。 调试完成后，可直接关闭调试窗口。                                                                              |
| 格式化    | 单击该按钮对选中的 SQL 语句或当前 SQL 窗口中的所有 SQL 语句进行统一的格式化（缩进、换行和高亮关键字等操作）。                                                                                                                                                                             |
| 查找/替换  | 在查找框内输入内容以对脚本进行检索，查找后可在替换框内输入内容以对查找内容进行替换。                                                                                                                                                                                                 |
| 撤销     | 将脚本回退到上一步操作执行的结果。                                                                                                                                                                                                                          |
| 重做     | 执行 **撤销** 操作后，对脚本重新执行撤销前的操作。                                                                                                                                                                                                               |
| 大小写    | 提供 **全部大写** 、 **全部小写** 和 **首字母大写** 三种效果，将在脚本中选中的语句转换为对应形式。                                                                                                                                                                                 |
| 缩进     | 提供 **添加缩进** 和 **删除缩进** 两种效果，旨在脚本中选中的语句添加或删除包含的缩进。                                                                                                                                                                                          |
| 注释     | 提供 **添加注释** 和 **删除注释** 两种效果，旨在脚本中选中的语句转换为注释或转换为 SQL 语句。                                                                                                                                                                                    |
| IN 值转化 | 批量复制转化工具，适用于查询数据时对复制的行或列结果进行格式转化。 将批量数据粘贴在 SQL 编辑区后，选择复制的数据，单击 **IN 值转化** 按钮，即可转化成 in（'A','B'）格式。 <li> 列值分隔符号为换行符。</li>   <li> 行值分隔符为空格或 TAB 值。 </li>    |



储存过程运行结果页面 
-------------------------------

![存储过程-运行结果](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/2334377361/p350898.png)

存储过程执行完毕后，可查看 **运行结果** 和 **DBMS 输出** 信息。


|   功能    |                   说明                   |
|---------|----------------------------------------|
| 运行结果    | 在运行结果页签中，可查看存储过程运行状态、参数、类型、值、返回类型和返回值。 |
| DBMS 输出 | 在 DBMS 输出页签中，可查看存储过程 DBMS 输出信息。        |


