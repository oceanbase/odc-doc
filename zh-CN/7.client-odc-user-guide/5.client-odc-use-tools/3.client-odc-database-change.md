数据库变更 
==========================



概述 
-----------------------

OceanBase 开发者中心（OceanBase Developer Center，ODC）SQL 窗口中的语句是同步执行的，当语句运行时间过长时可能会出现执行超时的问题。可使用数据库变更工具来运行耗时较高的 SQL 语句以避免语句执行超时。

![Image 441](https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/8492996461/p293273.png)


操作步骤 
-------------------------

新建数据库变更的步骤如下：

1. 进入 **数据库变更** 面板。

   1. 在 ODC 首页，单击目标连接进入对应的数据库对象管理页面；

      
   
   2. 单击顶部导航栏中的 **工具** 标签；

      
   
   3. 在弹出的下拉菜单中选择 **数据库变更** 以弹出 **新建数据库变更** 面板。

      
   

   

2. 查看 **所属连接** （当前连接，不可切换）。

   

3. 选择 **所属库** （默认显示当前库）。

   

4. 指定 **SQL 内容** 。

   数据库变更支持两种指定 SQL 内容的方式：
   * **SQL 录入** ：SQL 录入为默认方式，可在编辑区中直接录入 SQL 脚本。

     > **说明** <br>
     > 单击 **IN 值转化** 按钮，可将批量复制的数据转化成 in（'A','B'）格式。
     > 列值分隔符号为换行符；行值分隔符为空格或 TAB 值。

   * **上传附件** ：选择上传附件方式后，单击文件池进入文件资源管理器选择要导入的文件或者直接将导入文件拖入文件池中以完成文件上传。

     > **说明** <br>
     > 单击 **IN 值转化** 按钮，可将批量复制的数据转化成 in（'A','B'）格式。<br>
     > 列值分隔符号为换行符；行值分隔符为空格或 TAB 值。
   
   * **上传附件** ：选择上传附件方式后，单击文件池进入文件资源管理器选择要导入的文件或者直接将导入文件拖入文件池中以完成文件上传。

     > **说明** <br>
     > - 最多支持上传 500 个文件，总文件大小不超过不超过 256 MB。<br>
     > - 默认附件按上传的先后排序，可拖拽改变顺序，任务执行时按文件顺序执行。<br>
     > - 当前只支持上传 .sql 后缀的 SQL 文件。


5. 指定 **回滚方案** 。

   回滚方案支持 SQL 文本录入及上传附件方式，具体参见"指定 SQL 内容"步骤。
   

6. **分隔符** ：支持 delimiter 分隔符号。

   

7. **查询结果限制** ：支持设置查询结果限制 (1-100w)。

   

8. 指定 **任务错误处理** 方式。

   异步执行工具提供两种任务错误处理方式：
   * **停止任务** ：停止任务为默认方式，运行脚本的过程中出现错误时会停止运行。

     
   
   * **忽略错误继续任务** ：选择忽略错误继续任务方式，在运行脚本出现错后将跳过错误语句继续执行。


9. 指定 **执行超时时间** 。

   在 **执行超时时间** 文本框中输入数字指定语句执行超时时间，单位为小时（默认超时时间为 48 小时，最大不超过 480 小时）。
   

10. 指定 **任务描述** （选填）。

    可在 **任务描述** 文本框中输入不超过 200 个字符的描述信息，该项为选填项。
    

11. 生成数据库变更任务。

    在面板中完成上述信息的指定后，单击右下角的 **新建** 按钮以提交信息生成数据库变更任务。
    

12. 新建完成后，会自动转入 **任务中心** > **数据库变更** 页面，可单击 **查看** 按钮，在任务详情页面查看 **任务信息** 、 **执行结果** 和 **任务日志** 。
