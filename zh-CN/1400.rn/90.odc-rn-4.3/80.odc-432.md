# ODC V4.3.2

<main id="notice" type='notice'>
  <h4>注意</h4>
  <ul>
  <li>从 ODC V4.2.0 之前的版本升级到 ODC V4.3.2 版本前，请务必阅读本篇文档中的<strong>升级注意事项</strong>。</li>
  <li>使用 ODC V4.3.2 版本前，请关注 <a href="../../200.odc-overview/500.product-limits.md">ODC V4.3.2 产品能力限制</a>。</li>
  </ul>
</main>

## 升级注意事项

- 数据源

   - ODC V4.2.0 及之后的版本，连接配置概念调整为数据源。

   - ODC V4.2.0 及之后的版本，个人连接迁移到个人空间，以数据源的形式存在。

   - ODC V4.2.0 及之后的版本，公共连接迁移到团队空间，以数据源的形式存在。

   - ODC V4.2.0 及之后的版本，原公共连接中的只读、读写账号，升级后仅保留读写账号。

- 用户权限

   - private_connection/apply_connection 角色已在 ODC V4.2.0 及之后的版本中下线，升级到 ODC V4.2.x 版本的用户引用的 private_connection/apply_connection 角色对应的权限不再生效。

   - 资源组已在 ODC V4.2.0 及之后的版本中下线。

   - 连接访问权限已在 ODC V4.2.0 及之后的版本中下线，ODC V4.2.x 中通过项目管控实现对数据库的访问控制。

- 系统设置

   - 已 ODC V4.2.0 及之后的版本中下线。

- 工单模块

   - ODC V4.2.0 之前的版本发起的工单仅支持在 **我发起的** 的分类下查看用户自己发起的工单。

- 分区计划

   - 该功能在 ODC V4.2.0 版本中升级，升级到 ODC V4.2.x 版本后，在 ODC V4.2.0 之前版本创建的历史分区计划任务将停止运行。

- SQL 计划

   - 该功能在 ODC V4.2.0 版本中升级，升级到 ODC V4.2.x 版本后，在 ODC V4.2.0 之前版本创建的历史 SQL 计划任务将停止运行。

- 任务流程

   - 该功能模块在 ODC V4.2.0 及之后的版本中下线，ODC V4.2.x 中已上线风险等级模块实现对应效果。

- 数据脱敏

   - 该功能模块在 ODC V4.2.0 版本中升级，升级到 ODC V4.2.x 版本后，在 ODC V4.2.0 之前版本创建的数据脱敏配置不再生效。

- 堡垒机集成

   - 该功能在 ODC V4.2.2 中支持账号集成和数据源配置自动填写，暂不支持 SQL 审核集成，后续版本恢复。

- 历史会话

   - 历史会话在 ODC V4.2.0 及之后的版本中下线，ODC V4.2.x 中默认会保存 SQL 窗口的使用状态。

本次 9 月发版的 OceanBase 开发者中心（OceanBase Developer Center，ODC）V4.3.2 版本主要更新以下功能：

- 逻辑库支持：引入了全新的逻辑库功能，为分库分表场景提供了快速、可靠且易用的变更基础。本次更新包括配置逻辑库、管理访问权限，以及提供提取逻辑表、新建逻辑表和执行 DDL 变更的能力。

- 数据归档链路扩展：新增支持两条归档链路，在 ODC V4.3.1 版本支持 MySQL 到 OceanBase MySQL 归档的基础上，增加支持 Oracle 到 OceanBase Oracle 和 PostgreSQL 到 OceanBase MySQL 的归档。

- SQL 开发和数据源管理优化：提升了 SQL 开发页面、数据源和表单的易用性，涵盖定位键、资源树对象、SQL 执行结果等 10 多项功能改进。

更多更新详情，请参见功能变更。

### 版本信息

* **当前版本：** V4.3.2

* **前置版本：** V4.3.1-BP

* **发版时间：** 2024 年 9 月 26 日

* **支持的升级路径：** 对于 ODC V2.0.0 及之后的版本，均可直接升级至本版本。

### 功能变更

- 逻辑库

  - 支持配置、移除逻辑库。

  - 支持根据物理库中物理表的拓扑分布，自动提取逻辑表，提高效率。

  - 提供了新建逻辑表功能，支持按照提示进行配置即可新建逻辑表。

  - 支持通过数据库变更工单，快速提交关于逻辑库的 DDL 变更请求。

  - 为逻辑表提供结构一致性检查能力，以便及时发现结构不一致的物理表。

  - 逻辑库纳入已有的库表权限管理体系，保障逻辑库数据访问安全。

- 数据归档

  新增以下归档链路：

  - 支持 Oracle 到 OceanBase Oracle 的归档链路。

  - 支持 Oracle 到 Oracle 的归档链路。

  - 支持  OceanBase Oracle 到 Oracle 的归档链路。

  - 支持 PostgreSQL 到 OceanBase MySQL 的归档链路。

- 数据清理

  新增以下清理链路：

  - 支持对 Oracle 数据库进行数据清理。

  - 支持对 PostgreSQL 数据库进行清理。

- SQL 检查

  - 针对 OceanBase MySQL 及 MySQL 数据源新增 SQL 影响行数检查规范，通过该规范可限制大 SQL 变更的执行，保障业务稳定。

- 分区计划

  - 针对日期类型字段分区设置，新增分区名和分区内容范围一致的分区命名选项。

- 数据导入

  - 桌面版 ODC 支持导入时直接选择文件夹导入数据内容。

- SQL 窗口

  - 在 SQL 开发页面单击产品标志即可返回项目列表页，为用户返回首页提供功能入口。

  - 优化 SQL 窗口定位键的交互，被定位的数据库自动展示在可视区内。

  - 在 SQL 窗口执行的 SQL，支持在查询结果页签直接查看 DB 执行耗时。

  - 优化资源树对象的排序方式，资源树对象（数据源、项目、数据库、表、视图等）默认按名称排序。

  - 支持通过 SQL 窗口资源树上的数据库直接发起全部类型的工单。

- 数据源

  - 数据源下的数据库支持根据是否可用、是否已分配项目进行快速筛选。

  - 数据源连接初始化脚本交互优化，为常用的参数配置提供快捷的帮助引导。

- 易用性

  - 统一优化了所有空数据状态的功能（数据源、项目、脚本、资源树等）交互。

  - 统一优化所有功能（数据库运维、敏感列扫描、项目新增数据库）的数据源选择交互。

  - 对常用表单（工单列表、数据库列表、用户列表）展示不全的列（工单描述列、所属数据源列、排序规则列、用户角色列等）支持鼠标悬停展示完整内容。

  - 在意见反馈页增加 github issue 地址，用户可通过开源社区快速反馈产品意见。

- 其他

  - SSO 集成支持 Azure AD。

  - 更新平台登录用户账号密码策略，最新策略为：<br/> 密码为长度 8~32 位, 包含以下四种类型字符至少三种及以上：数字（0~9）、大写字母（A~Z）、小写字母(a~z)、特殊符号（全部的英文特殊字符）。

### 问题修复

- 数据对象

  - 修复上传文件后，格式化含有大字段类型的列生成的 SQL 语句，执行时报错的缺陷。

  - 修复 MySQL 模式下 TINYINT 类型的精度不正确的缺陷。

  - 修复无法通过图形化界面编辑值为 NULL 的 CLOB 或 BLOB 类型的列的缺陷。

- 变更管控

    - 修复结构对比任务生成的变更 SQL 语句中，`tinyint` 列类型（MySQL 数据源）的精度不正确的缺陷。

    - 修复分区名被误识别为表名，导致报错无对应表权限的缺陷。

    - 修复 `rename table old_table to new_table` 中的 `new_table` 被误判断为需要 `new_table` 的表权限的缺陷。

    - 修复 MySQL 5.7 版本模拟数据任务可能失败的缺陷。

    - 修复单击手动执行后，手动执行按钮依然处于可单击状态的缺陷。

    - 修复风险识别规则过多时，创建或者更新失败的缺陷。

    - 修复风险识别规则过多时，页面无法上下滚动的缺陷。

    - 修复周期任务允许设置小于十分钟的调度周期的缺陷。

- 导入导出

    - 修复将 PL 和 表 的 DDL 合并成一个 SQL 文件导出后，再次导入时会由于分句错误导致失败的缺陷。

    - 修复 Windows 系统下使用桌面版 ODC 导出数据时，可能由于路径问题导致导出失败的缺陷。

    - 修复导出 OceanBase Oracle 模式的结果集时，如果表名为小写，导出文件为空的缺陷。	

    - 修复 Windows 系统下使用桌面版 ODC 导出原生 MySQL 数据失败的缺陷。	

    - 修复导出表类型为 BigDecimal 时报错的缺陷。

    - 修复 SQL 语句中使用 `*` 和 `NVL` 函数时，导致导出结果集失败的缺陷。

    - 修复表中包含 SDO-GEOMETRY 数据类型时，导出结果集失败的缺陷。

- 数据归档

    - 修复修改数据归档限流参数可能报错的缺陷。

    - 修复已执行的归档任务详情中显示扫描记录的计数不精确的缺陷。

    - 修复归档 OceanBase Oracle 类型数据需要 DBA 权限的缺陷。

- 数据源

    - 修复测试连接 OceanBase SYS 租户数据源时，选择了 OceanBase Oracle 类型，依然可以测试连接成功的缺陷。

- 其他

    - 修复已部署负载均衡服务的场景下，SSO 登录可能失败的缺陷。
    
    - 修复启动参数 `ODC_APP_EXTRA_ARGS` 无效的缺陷。

### 已知问题

* 客户端版 ODC 不支持安装在中文目录名中。

* 导出包含虚拟列的表时，导出的数据文件和内容显示异常。

* Web 版 ODC 中，结构或数据的导入量上限为 2GB，超限文件无法上传。

* Web 版 ODC 中，结构或数据的导出量上限为 2GB，超限会导致最终导出数据不完整。

* 导出任务详情中，导出对象的数据总记录数依赖 OceanBase 数据库视图，并非精准值。

* 需设置 `ob_enable_trace_log` 参数为 `on`，否则只显示首次执行的 SQL 的执行计划。

## 相关文档

- [开源版 ODC](https://github.com/oceanbase/odc)

- [企业版 ODC](https://www.oceanbase.com/product/odc)