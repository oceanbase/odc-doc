# ODC V4.2.2

<main id="notice" type='notice'>
  <h4>注意</h4>
  <ul>
  <li>从低版本升级到 ODC V4.2.0 及之后的版本前，请务必阅读本篇文档中的 <strong>ODC V4.2.2 升级注意事项</strong>。</li>
  <li>使用 ODC V4.2.2 及之后的版本前，请关注 <a href="../../200.odc-overview/500.product-limits.md">ODC V4.2.2 产品能力限制</a>。</li>
  </ul>
</main>

## 升级注意事项

- 数据源

   - ODC V4.2.0 及之后的版本，连接配置概念调整为数据源。

   - ODC V4.2.2 版本暂不支持新建 ODP 数据源，后续版本恢复。

   - ODC V4.2.0 及之后的版本，个人连接迁移到个人空间，以数据源的形式存在。

   - ODC V4.2.0 及之后的版本，公共连接迁移到团队空间，以数据源的形式存在。

   - ODC V4.2.0 及之后的版本，原公共连接中的只读、读写账号，升级后仅保留读写账号。

- 用户权限

   - private_connection/apply_connection 角色已在 ODC V4.2.0 及之后的版本中下线，升级到 ODC V4.2.x 版本的用户引用的 private_connection/apply_connection 角色对应的权限不再生效。

   - 资源组已在 ODC V4.2.0 及之后的版本中下线。

   - 连接访问权限已在 ODC V4.2.0 及之后的版本中下线，ODC V4.2.x 中通过项目管控实现对数据库的访问控制。

- 系统设置

   - 已 ODC V4.2.0 及之后的版本中下线。

- 工单模块

   - ODC V4.2.0 之前的版本发起的工单仅支持在 **我发起的** 的分类下查看用户自己发起的工单。

- 分区计划

   - 该功能在 ODC V4.2.0 版本中升级，升级到 ODC V4.2.x 版本后，在 ODC V4.2.0 之前版本创建的历史分区计划任务将停止运行。

- SQL 计划

   - 该功能在 ODC V4.2.0 版本中升级，升级到 ODC V4.2.x 版本后，在 ODC V4.2.0 之前版本创建的历史 SQL 计划任务将停止运行。

- 任务流程

   - 该功能模块在 ODC V4.2.0 及之后的版本中下线，ODC V4.2.x 中已上线风险等级模块实现对应效果。

- 数据脱敏

   - 该功能模块在 ODC V4.2.0 版本中升级，升级到 ODC V4.2.x 版本后，在 ODC V4.2.0 之前版本创建的数据脱敏配置不再生效。

- 堡垒机集成

   - 该功能在 ODC V4.2.2 中支持账号集成和数据源配置自动填写，暂不支持 SQL 审核集成，后续版本恢复。

- 历史会话

   - 历史会话在 ODC V4.2.0 及之后的版本中下线，ODC V4.2.x 中默认会保存 SQL 窗口的使用状态。

## ODC V4.2.2-BP

本次 11 月发版的 OceanBase 开发者中心（OceanBase Developer Center，ODC）V4.2.2-PB 版本升级了 JDBC 组件到 2.4.7.1、提升数据归档任务性能，同时修复了某些缺陷。

### 版本信息 

* **当前版本：** V4.2.2-BP

* **前置版本：** V4.2.2

* **发版时间：** 2023 年 11 月 24 日

* **支持的升级路径：** 对于 ODC V2.0.0 及之后的版本，均可直接升级至本版本。

### 支持的 OceanBase 数据库版本

OceanBase 开发者中心 V4.2.2-BP 版本支持下述版本的 OceanBase 数据库。

| ODC 支持的数据源类型 | 支持版本 |
| ------ | ------ |
| OceanBase Oracle <br> Cloud Oracle <br> OceanBase MySQL <br> OB Cloud MySQL | <ul><li> OceanBase V1.4.x </li><li> OceanBase V2.0.x </li><li> OceanBase V2.1.x </li><li> OceanBase V2.2.x </li><li> OceanBase V3.1.x </li><li> OceanBase V3.2.x </li><li> OceanBase V4.0.0 </li><li> OceanBase V4.1.0 </li><li> OceanBase V4.2.0 </li><li> OceanBase V4.2.1 </li><li> OceanBase 社区版</li></ul>|
| MySQL | MySQL 5.7 |

### 功能变更

- 升级 JDBC 组件到 2.4.7.1。

- 提升数据归档任务性能。

### 问题修复

- 修复执行数据归档子任务时，更新限流器配置未生效的缺陷。

- 修复执行数据归档任务时，清理源端已归档数据未执行的缺陷。

- 修复自动扫描敏感列场景下，输入恶意识别规则会导致正则表达式拒绝服务的缺陷。

- 修复 MySQL 模式下以科学计数法展示 NUMBER 类型数据的缺陷。

- 修复运行 PL 语句时，无法查看游标内容的缺陷。

- 修复数据库无语法错误时，SQL-Check 依然会提示语法错误的缺陷。

- 修复 CLOB/BLOB 类型的表导出数据为空的缺陷。

- 修复 CLOB 类型上传大附件查看文本有误的缺陷。

- 修复 OceanBase MySQL 模式无法解析包含 `DEFINER=root@%` 的 PL 语句的缺陷。

## ODC V4.2.2

本次 11 月发版的 OceanBase 开发者中心（OceanBase Developer Center，ODC）V4.2.2 版本旨在对 MySQL 数据源提供了全面的支持，您可以轻松录入 MySQL 数据源，并使用全面的 SQL 开发功能对数据库进行高效地开发。同时，我们还为 MySQL 数据源配套了变更风险管控、数据生命周期管理以及安全合规能力等一系列实用功能，帮助您更好地管理和保护数据。

同时本版本还对 SQL 开发交互的易用性进行了全面升级，主要包括资源树的布局、数据源及数据库关键信息展示、搜索能力强化、SQL 窗口打开及切换的效率提升等。在其它产品方向上也进行了相应的优化，主要包括数据脱敏、数据源管理、表对象管理等，详情参见版本变更。

除此之外，本版本还全面适配了 OceanBase V4.2.0/V4.2.1，可使用本版本管理 OceanBase V4.2.0/V4.2.1 数据源。

### 版本信息 

* **当前版本：** V4.2.2

* **前置版本：** V4.2.1

* **发版时间：** 2023 年 11 月 8 日

* **支持的升级路径：** 对于 ODC V2.0.0 及之后的版本，均可直接升级至本版本。

### 支持的 OceanBase 数据库版本

OceanBase 开发者中心 V4.2.2 版本支持下述版本的 OceanBase 数据库。

| ODC 支持的数据源类型 | 支持版本 |
| ------ | ------ |
| OceanBase Oracle <br> Cloud Oracle <br> OceanBase MySQL <br> OB Cloud MySQL | <ul><li> OceanBase V1.4.x </li><li> OceanBase V2.0.x </li><li> OceanBase V2.1.x </li><li> OceanBase V2.2.x </li><li> OceanBase V3.1.x </li><li> OceanBase V3.2.x </li><li> OceanBase V4.0.0 </li><li> OceanBase V4.1.0 </li><li> OceanBase V4.2.0 </li><li> OceanBase V4.2.1 </li><li> OceanBase 社区版</li></ul>|
| MySQL | MySQL 5.7 |

### 功能变更

* MySQL 数据源支持的功能

  | 类别 | 功能 | 支持情况 |
  | ------ | ------ | ------ |
  | 数据生命周期管理 | 数据清理 | ✔️ |
  |  | 数据归档（MySQL 到 OBMySQL/MySQL 到 MySQL/ OBMySQL 到 MySQL） | ✔️ |
  | 变更风险管控 | SQL 开发规范 | ✔️ |
  |  | 审批流程配置 | ✔️ |
  | 安全合规 | 操作记录 | ✔️ |
  |  | 数据脱敏 | ✔️ |
  | SQL 窗口 | SQL 执行 | ✔️ |
  |  | SQL 检查 | ✔️ |
  |  | 自动补全 | ✔️ |
  |  | 执行计划 | ✔️ |
  |  | 格式化 | ✔️ |
  |  | 结果集查看 | ✔️ |
  |  | 结果集搜索 | ✔️ |
  |  | 结果集编辑 | ✔️ |
  |  | 结果集导出 | ❌ |
  |  | 脚本管理 | ✔️ |
  |  | 代码片段 | ✔️ |
  |  | 设置 | ✔️ |
  | 白屏对象管理 | 表 | ✔️ |
  |  | 视图 | ✔️ |
  |  | 函数 | ✔️ |
  |  | 存储过程 | ✔️ |
  | PL 能力 | 编译 | ❌ |
  |  | 运行 | ✔️ |
  |  | 调试 | ❌ |
  | 工单 | 导入 | ❌ |
  |  | 导出 | ❌ |
  |  | 模拟数据 | ✔️ |
  |  | 数据库变更 | ✔️ |
  |  | 影子表同步 | ❌ |
  |  | SQL 计划 | ✔️ |
  |  | 分区计划 | ❌ |
  | 数据库运维 | 会话管理 | ✔️ |
  |  | 会话变量管理 | ✔️ |
  |  | 回收站管理 | ❌ |
  |  | 命令行窗口 | ✔️ |

* 其它模块变更

  | **模块** | **变更点** |
  | ------ | ------ |
  | SQL 开发 | <ul><li> 升级了资源树的布局，由上下结构升级为顶部切换布局，为数据库对象预留了更多的可操作空间。</li><li> 升级了资源树的筛选能力，支持按数据源类型、环境标等维度进行筛选，提升了检索的效率。</li><li> 升级了资源树的搜索能力，支持按数据源库、表等对象纬度搜索，提升了搜索的灵活性。</li><li> 在资源树内，数据源、数据库的展示包含了类型、状态、环境标等因子，提升了信息获取的直观性。</li><li> 升级了 SQL 窗口数据库切换交互，支持搜索匹配，缩短了切换数据库耗时。</li><li> 支持了表对象右键打开 SQL 窗口、复制 SQL 窗口，提升了打开 SQL 窗口的效率。</li><li> 在 SQL 窗口页签栏添加了匿名块窗口的快捷打开入口，方便快速打开匿名块窗口。</li></ul> |
  | 数据源管理 | 提供数据源连接初始化脚本配置能力，比如日期格式、弱读等设置可在建连时进行初始化。 |
  | 表对象管理 | <ul><li> 针对表对象的索引，增加了是否可用状态标，方便查看索引的有效性。</li><li> 针对 OceanBase MySQL 模式，增加了 json 数据类型支持。</li></ul> |
  | 数据脱敏 |  数据脱敏能力覆盖了视图列，支持对视图数据进行脱敏管理。同时全面升级了数据脱敏配置的交互，提升配置过程的易用性。 |
  | 导数 | 对导数能力进行了强化，支持导出类型对象，同时在导数过程中支持显示将要导出的数据库对象。 |
  | 堡垒机集成 | 支持账号集成和数据源配置自动填写，暂不支持 SQL 审核集成，后续版本恢复。 |
  | OB 适配 | 对 OceanBase V4.2.0/V4.2.1 版本进行了全面适配，可使用本版本管理 OceanBase V4.2.0/V4.2.1 数据源。 |
  | 其它 | <ul><li> 支持非对称加密，减小安全隐患，提升安全性。</li><li> 会话管理支持根据状态筛选，方便快速定位会话。</li></ul> |

### 问题修复


* 导入导出

  * 修复导入的 CSV 文件名中包含 `-` 时，导入失败的缺陷。

  * 修复导出的程序包中未包含包体的缺陷。

* 表

  * 修复查看列信息时，未显示字符串数据类型的长度的缺陷。

* 数据归档

  * 修复用户申请终止任务时，审批界面无通过按钮的缺陷。

  * 修复周期性数据归档任务界面无取消按钮的缺陷。

  * 修复包含子查询的过滤条件的任务执行失败的缺陷。

* SQL 执行

  * 修复 OceanBase Oracle 模式下，SQL 窗口中 VARCHAR 数据类型未高亮显示的缺陷。

  * 修复 SQL 执行耗时统计错误的缺陷。

  * 修复 MySQL 模式不支持 get_diagnostics 的缺陷。

* 结果集

  * 修复列模式下的数据为空的缺陷。

  * 修复导出结果集时，将文件保存为 Excel 格式失败的缺陷。

* PL 调试

  * 修复 OceanBase V4.2.x 模式下，调试匿名块时无法设置断点的缺陷。

  * 修复无法调试程序包的子程序的缺陷。

* 数据库变更

  * 修复数据库变更任务启动时间过长的缺陷。

* 会话管理

  * 修复会话管理页面中，切换数据库时报错的缺陷。

* 项目

  * 修复项目中添加数据库时，仍显示已删除的数据库的缺陷。

## 已知问题

* 客户端版 ODC 不支持安装在中文目录名中。

* 导出包含虚拟列的表时，导出的数据文件和内容显示异常。

* Web 版 ODC 中，结构或数据的导入量上限为 2GB，超限文件无法上传。

* Web 版 ODC 中，结构或数据的导出量上限为 2GB，超限会导致最终导出数据不完整。

* 导出任务详情中，导出对象的数据总记录数依赖 OceanBase 数据库视图，并非精准值。

* 需设置 `ob_enable_trace_log` 参数为 `on`，否则只显示首次执行的 SQL 的执行计划。

## 相关文档

- [开源版 ODC](https://github.com/oceanbase/odc)

- [企业版 ODC](https://www.oceanbase.com/product/odc)