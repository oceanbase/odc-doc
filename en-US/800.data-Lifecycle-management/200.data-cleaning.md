# Clean up data

## Background information

After you archive data in the source database to the destination database, OceanBase Developer Center (ODC) allows you to delete the data from the source database to improve the query performance and reduce the online storage costs.

This topic describes how to clean up archived data by submitting a ticket.

## Technical mechanism

![1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/422/800.data-Lifecycle-management/200.data-cleaning/1EN.png)

## Prerequisites

- The table to be cleaned up has a primary key.

## Considerations

- Pay attention to the following rules:

   - You must connect to an OceanBase data source by using OceanBase Database Proxy (ODP). At present, you cannot archive data in a directly connected OceanBase data source.

   - At present, an OceanBase data source must be a cluster instance. Therefore, you must configure the cluster instance name when you create an OceanBase data source.

   - You must configure a sys tenant account for an OceanBase data source.

   - CPU and memory exhaustion prevention is not supported for a MySQL data source.

- Supported data sources for data cleanup are as follows:

   - OceanBase MySQL data sources

   - MySQL data sources

- Data cleanup is not supported in the following cases:

   - The table does not have a primary key.

   - The table contains fields of the bit, enum, set, xml, or geometry type.

   - The archiving condition contains a LIMIT clause.

   - The table contains a foreign key.

## Create a data cleanup task

Example: Clean up the `student` table in the `odc_test` database.

| Parameter | Example value |
| ------ | ------ |
| Data source | mysql_4.2.0 |
| Source database name | odc_test |
| Table name | student |

1. On the **Ticket** tab in the left-side navigation pane of the homepage, click **Data Cleanup** and then click **Create New**.

   ![2](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/422/800.data-Lifecycle-management/200.data-cleaning/2EN.png)

3. In the **Create New** panel, configure the following parameters.

   ![3](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/422/800.data-Lifecycle-management/200.data-cleaning/3EN.png)

   | Parameter | Description |
   |--------|-------|
   | Source Database | The database to which the table belongs.  |
   | Variable Configuration | Optional. You can define variables and set time offsets to filter rows to be cleaned up.  |
   | Cleanup Scope | <ul><li>**Partially Cleaned**: specifies to clean up only tables that meet filtering conditions in the database. <br>You can configure filtering conditions by using constants or referencing variables defined in **Variable Configuration**. For example, in `create<'${create_time}'`, `create_time` is the name of a variable configured in **Variable Configuration** and `create` is a field in the table to be archived. </li><li>**Whole Library Cleaning**: specifies to clean up all tables in the database. </li></ul> |
   | Execution Mode | The execution mode of the task. Valid values: **Execute Now**, **Scheduled Execution**, and **Periodic Execution**.  |
   | Task Settings | Configure a throttling strategy. <ul><li>**Row Limit**: limits the total number of data rows operated per second. </li><li>**Data Size Limit**: limits the total size of data operated per second. </li></ul> |
   | Remarks | Optional. Additional information about the task, which cannot exceed 200 characters in length.  |
3. Click **Create**.

4. After the task is generated, choose **Tickets** > **Data Cleanup** to view the task.

   ![4](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/422/800.data-Lifecycle-management/200.data-cleaning/4EN.png)

## View a data cleanup task

### Task information

1. In the data cleanup task list on the **Ticket** tab, click **View** in the **Actions** column of the target task.

2. In the **Ticket Details** panel, click the **Basic Information** tab and view information such as the task type, source database, destination database, variable configurations, archiving scope, and execution mode.

![5](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/422/800.data-Lifecycle-management/200.data-cleaning/5EN.png)

### Execution records

In the **Task Details** panel, click the **Execution Records** tab and view task status and perform operations such as task retry and rollback.

![6](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/422/800.data-Lifecycle-management/200.data-cleaning/6EN.png)

### Task logs

In the **Task Details** panel, click the **Operating Records** tab and view the approval status and records of the task.

![7](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/422/800.data-Lifecycle-management/200.data-cleaning/7EN.png)

## References

- [Archive data](../800.data-Lifecycle-management/100.data-archiving.md)
